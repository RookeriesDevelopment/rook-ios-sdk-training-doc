

# RookMotion iOS SDK

RookMotion iOS SDK  allow new and existing applications to integrate RookMotion functionalities for training measurement, tracking, and analysis.

RookMotion SDK  is designed with the intention to be:

* Fast Integration: Useful to integrate fast and easy using pre-created views with RookMotion design and pre-automated flows. For reference: 4h to re-create the demo app.
* Full personalization: Better for apps with a dedicated development team, developers can call each SDK function in theirs desired order and create and fill their with a personalized UI.

These functionalities are:

* User's info, trainings, rewards, and statistics management in complement with the RookMotion API.
* Bluetooth management for training sensors.

## Keywords

| keyword      | Def |
| ----------- | ----------- |
| **Client**  | Billing account. Person or company which contracts the usage of the API. A client can have multiple centers, branches, rooms or be virtual |
| **client_key**  | Unique identifier provided by the RookMotion API account manager for each center/branch/room of the client. This is used to redirect client API request to his correspondent tenancy. |
| **Chain**  | An entity or brand operating under the same client's entity |
| **chain_uuid**  | Unique identifier for a chain entity. Cannot be created with the SDK. Chains are created directly with the API.|
| **Branch**  | A sucursal or branch of a chain entity |
| **branch_uuid**  | Unique identifier for a branch entity. Cannot be created with the SDK. Chains are created directly with the API.|
| **Room**  | A branch section or division where training is performed. This is the smallest part of the business structure. Rooms can be physical, remote or virtual.  |
| **room_uuid**  | Unique identifier for a branch entity. Cannot be created with the SDK. Chains are created directly with the API.|
| **token_level**  | Unique identifier for each entity of the business structure. Each API request requires a token_level which allows the API to identify the entity where the request/query should be performed. token_level's are created by the API when a chain or branch or room is created. |
| **User**  | A person which uses the RookMotion API through the client APP to perform trainings. |
| **user_uuid**  | Unique identifier for each user, it's generated by the RookMotion API for each user added with API.addUser.|
| **Sensor**  | A Bluetooth peripheral device with a training variable measurement such as heart rate.    |
| **sensor_uuid**  | Unique identifier for each training sensor, it's generated by the RookMotion API for each sensor added to the user with API.addSensor.|
| **Training**  | Routine or workout perfomed using a heart rate sensor where the measurement records are obtained, stored and proccessed using the RookMotion SDK/API.|
| **training_uuid**  | Unique identifier for each training, it's generated by the RookMotion API for each training added to the user with API.addTraining.|

## Contents

1. [Installation](#user-content-installation)
2. [Configuration](#user-content-configuration)
3. [Package usage](#user-content-package-usage)
    * [RMSensorManager class](#user-content-rmsensormanager-class)
    * [RMTrainingManager class](#user-content-rmtrainingmanager-class)
    * [RookTrainingManager class](#user-content-rooktrainingmanager-class)
    * [RMBasalCalculator class](#user-content-rmbasalcalculator-class)
    * [Network](#user-content-networkclass)
        * [Network class](#user-content-networkclass)
        * [RMApi class](#user-content-rmapi-class)
    * [RMStorageManager class](#user-content-rmstoragemanager-class)
    * [RMClass](#user-content-rmclass)
    * [RMCommunicationManager](#user-content-rmcommunicationmanager)
    * [RMModels](#user-content-rmmodels)


## Installation ##

### required software

To build a project using the RookMotion SDK you need to download and install
* [Xcode](https://developer.apple.com/xcode/) version 12.4 or later.
* [Cocoapods](https://guides.cocoapods.org/using/getting-started.html)

The IOS deployment minimum target is 13.1 and the swift version is 5.0.


RookMotionLink is available through CocoaPods. To install it, simply follow the next steps:

1. Creat a Podfile.

```console
pod init
```

2. Open your Podfile

```console
open .Podfile -a xcode
```

3. Add the following line to your Podfile

```Ruby
    pod 'RookMotionSDK', :git => "https://github.com/RookeriesDevelopment/rook-ios-sdk-training-pod.git"
```

4. Add the following lines at the end of the Podfile

```Ruby
post_install do |installer|
  installer.pods_project.targets.each do |target|
    target.build_configurations.each do |config|
      config.build_settings['BUILD_LIBRARY_FOR_DISTRIBUTION'] = 'YES'
      config.build_settings['IPHONEOS_DEPLOYMENT_TARGET'] = '13.0'
    end
  end
end
```

4. run pod install

```console
pod install
```

## Configuration ##

Add your client_key and your token_level to your ```AppDelegate.swift``` as follows:

* Import RookMotionLink statement:

```swift
import RookMotionSDK
```

* Add the following lines to your ```aplication(_:didFinishLaunchingWithOptions:)``` method, replacing *YOUR_KEY* and *YOUR_TOKEN* with your credential:

* The developer can set the `urlBase` to sandbox environment or production environment.

* The developer can set the `urlRemote` to sandbox environment or production environment for remote trainings.


```swift
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        // Override point for customization after application launch.
        let clientKey = "YOUR_KEY"
        let tokenLevel = "YOUR_TOKEN"
                let urlBase = "YOUR_BASE_URL"
                let urlRemote = "YOUR_REMOTE_URL"

        RMSettings.shared.setCredentials(client_key: clientKey, token: tokenLevel)
        RMSettings.shared.setUrlApi(with: urlBase)
        RMSettings.shared.setUrlRemote(with: urlRemote)
        RMSettings.shared.initRookMotionSDK()

        return true
    }
```
Before to use all the classes and method the following permissions have to be in the Info.plist file.

| Key | Type | String |
| ---- | ------ | ---- |
| Privacy - Bluetooth Always Usage Description | String | Allow Bluetooth access to connect with your training sensors devices.|
| Privacy - Bluetooth Peripheral Usage Description | String | Allow Bluetooth access to connect with your training sensors devices. |

**Note: It is important that: `Uses Bluetooth LE accessories` option is enabled in Background Mode.**


## Package usage

###  RMSensorManager class

```swift
final public class RMSensorManager
```

The RMSonsorManager class manages the detection of heart rate sensors nearby to the iOS device and available for connection. The developer is able to call the methods sequentially start/stop discovery to have more control of the discovery. This class also includes methods Bluetooth connection (actions and status), as well as notifications (actions and acquisition).

Note: Sensors are filtered to only those with the  **(180D)** Bluetooth service of heart rate measurement

| Returns      | Function |
| ----------- | ----------- |
|```void```      | ```startDiscovery()``` |
|```void``` | ```stopDiscovery()``` |
|```void```| ```connect(device: CBPeripheral)``` |
|```void```| ```disconnect(device: CBPeripheral)``` |
|```Int?```| ```connectionStatus()``` |
|```void```|```enableStepsReading()```|

#### startDiscovery()
```swift
public func startDiscovery()
```
Starts the sensors discovering, this is performed repeatedly until the stop method is called. Each time a sensor is found it's appended to a list that can be obtained with the onSensorDiscovered callback method.

Note: Sensors are filtered to only those with the  **(180D)** Bluetooth service of heart rate measurement

Throws **permission errors, errors when activating sensors, errors when reading properties of a sensor like a sensor's name**.
##### Example
```swift
// Discover sensors
let sensorManager  = RMSensorManager.shared

sensorManager.startDiscovery()

```

#### stopDiscovery()
```swift
public func stopDiscovery()
```
Stops the sensors discovering.

##### Example
```swift
let sensorManager  = RMSensorManager.shared

    sensorManager.startDiscovery()
        // Some process
    sensorManager.stopDiscovery()

```

#### connect()
```swift
public func connect(device : CBPeripheral)
```
Makes a connection to the sensor given as ```CBPeripheral``` discovered by the Scanner and stops the discovery process.

##### Example
```swift
// Connect a sensor
let sensorManager  = RMSensorManager.shared
let sensor = CBPeripheral

sensorManager.connect(device: sensor)
```

#### connectionStatus()
```swift
public func connectionStatus()
```
Retrieves the sensor Bluetooth connection status.

Status list:
**case 0**
`case disconnected`

* The sensor is disconnected.

**case 1**
`case connecting`

* The sensor is connecting.

**case 2**
`case connected`

* The sensor is connected.

**case 3**
`case disconnecting`

* The sensor is disconnecting.
##### Example
```swift
// Connection status of the sensor
let sensorManager  = RMSensorManager.shared
let sensorStatus = sensorManager.connectionStatus()
print("connection status \(sensorStatus)")
```

#### disconnect()
```swift
public func disconnect(device: CBPeripheral) throws
```

Drops the connection with the sensor.

##### Example
```swift

// Connect a sensor
let sensorManager  = RMSensorManager.shared
let sensor = CBPeripheral

sensor.disconnect(device: sensor)

```
The above methods use the next callbacks to receive updates from sensor activity.

### Callbacks

#### RMSensorConnectionCallback

A set of methods that provide the data related to the connection information

```swift
public protocol RMSensorConnectionCallback
```

|Fuction| Description|
|-------|------------|
|```onSensorConnected(rmSensor: CBPeripheral)```|Tells the callback when a connection has been established|
|```onSensorDisconnected(peripheral: CBPeripheral)``` |Tells the callback that the manager has disconnected from a peripheral.|

##### Example
```swift

class CustomClass: RMSensorConnectionCallback{
    let sensorManager  = RMSensorManager.shared

    let sensor = CBPeripheral

    override func viewDidLoad() {
        sensorManager.connectionDelegate = self
        sensorManager.connect(device: sensor)
        sensorManager.disconnect(device : sensor)
    }
    func onSensorConnected(rmSensor: CBPeripheral) {
        print(rmSensor)
    }

    func onSensorDisconnected(peripheral: CBPeripheral) {
        print(peripheral)
    }

}

```

#### RMSensorDiscoveryCallback

A set of methods that provide an array of sensors discovered

```swift
public protocol RMSensorDiscoveryCallback
```

|Fuction| Description|
|-------|------------|
|```onSensorDiscovered(sensorList: [CBPeripheral])```|Tells the callback when a sensor has been discovered and return an array of the devices discovered|
|```onDiscoveryStopped(sensorList: [CBPeripheral])``` |Tells the callback that the manager has stopped and return an array of the sensor discovered .|

##### Example
```swift

class CustomClass: RMSensorDiscoveryCallback{
    let sensorManager  = RMSensorManager.shared

    let sensor = CBPeripheral
    override func viewDidLoad() {
        sensorManager.dicoveryDelegate = self
        sensorManager.startDiscovery()
        sensorManager.stopDiscovery()
    }

    func onSensorDiscovered(sensorList: [CBPeripheral]){
        print(sensorList)
    }

    func onDiscoveryStopped(sensorList: [CBPeripheral]){
        print(sensorList)
    }

}

```

#### RMSensorCallback

A set of methods that provide the data related to the sensor information

```swift
public protocol RMSensorCallback
```

|Fuction| Description|
|-------|------------|
|```func onHeartRateReceived(bpm: Int, badContact: Bool)```|Tells the callback the bpm data or if there is bad band contact.|
|```onStepsReceived(steps: Int, cadence: Float, deltaSteps: Int)``` |Tells the callback that the step data has been changed |
|```onBatteryReceived(batteryLevel : Int)```|Tells the callback the battery level of the sensor.|

##### Example
```swift

class CustomClass: ViewController, RMSensorConnectionCallback {
    let sensorManager  = RMSensorManager.shared

    let sensor = CBPeripheral


    override func viewDidLoad {
        sensorManager.sensorDelegate = self
        sensorManager.connect(device: sensor)
    }

    func onHeartRateReceived(bpm: Int, badContact: Bool{
        print(bpm)
        print(badContact)
    }

    func onStepsReceived(steps: Int, cadence: Float, deltaSteps: Int) {
        print(steps)
        print(cadence)
        print(deltaSteps)
    }

    func onBatteryReceived(batteryLevel : Int) {
        print(batteryLevel)
    }
}

```

### RookTrainingManager class

```swift
public class RookTrainingManager
```

RookTrainingManager class tracks the user’s training using Bluetooth sensors handling all the involved steps, storage, processing of the training data, and upload it to server, this class runs one training session at a time

#### Properties

| Name | Type | Description |
| ---- | ---- | ----------- |
| trainingSensor | ```CBPeripheral?``` | Reference to sensor that will be used for training. |
|  training | [RMTrainingInfo](#user-content-rmtriaininginfo) | This model object that contains all the data of a training |
| duration | ```Float``` | Variable to set the training duration |
| isTrainingActive | ```Bool``` | Variable to know if the training is active or not. |
| isTimerRunning | ```Bool``` | Variable to know if the timer of duration is already running. |
| firstStart | ```Bool``` | Variable to know if it is the first start of the training. |
| trainingDelegate | `RookTrainingManagerDelegate` | The delegate receives notifications when a training session’s data changes. |

#### RookTrainingManagerDelegate

The delegate receives notifications when a training session’s data changes.

#### Methods

| function      | Description |
| ----------- | ----------- |
| `func durationUpdated(duration: Int)` | Tells the delegate that the duration of the workout has changed. |
| `func heartRateDataUpdated(hrData: RMHrDerivedRecord)` | Tells the delegate that a new hear rate event has been collected. |
| `func stepsUpdated(stepDerivedData: RMStepDerivedRecord)` | Tells the delegate that a new step event has been collected. |
| ` func batteryLevelUpdated(batteryLevel: Int)` | Tells the delegate that the battery level has changed. |
| `func handleSensorDisconnected(peripheral: CBPeripheral)` | Tells the delegate that a sensor has disconnected. |
| `func handleSensorConnected(peripheral: CBPeripheral)` | Tells the delegate that a sensor has connected.  |


#### Methods

| function      | Description |
| ----------- | ----------- |
| `func startTraining()` | Starts the training session activity |
| `func connectSensor(_ sensor : CBPeripheral)` | Starts a connection with a given peripheral |
| `func finishTraining(sensor: CBPeripheral? = nil, completion: @escaping (RMResponse, RMTrainingResponse) -> Void)`| Ends the training session. |
| `func cancelTraining(sensor: CBPeripheral?)` | Cancels the training session. |
| `func pauseTraining()` | Pauses the workout session. |
| `func storeBicycleRecord(resistance: Float, cadence: Int, power: Float)` | Stored a bicycle record in the training session. |

#### startTraining()

```swift
public func startTraining()
```

**Note: A user have to be stored in the local data in order to perform this  action, if there is not user stored, the calories and the heart rate effort will  not be calculated**

Automates the Bluetooth methods for sensor discovery, selection, connection, re-connection, notification enabling, and data recording. While the stop method is not called, this process will keep the sensor connected and notifying, in case of disconnection a reconnection process will be performed.

Every time the sensor send information, the training data will be generated and available in the [override methods](#user-content-override-methods)

Training data includes training duration, heart rate, steps, calories, effort...  If the sensor has no steps measurement, the steps will be 0.

Note: Before calling this method it is recommended to establish a connection with a sensor using [connectSensor](#user-content-connectsensor) and configure the [training](#user-content-rmtraininginfo) object


#### connectSensor()

```swift
public func connectSensor(_ sensor : CBPeripheral)
```

Starts a connection with a given peripheral, when the connection is established, the callback methods will return the sensor data

##### Example
```swift

#### finishTraining()

```swift
public func finishTraining(sensor: CBPeripheral? = nil, completion: @escaping (RMResponse, RMTrainingResponse) -> Void)
```
Automates the Bluetooth methods for sensor disconnection, training data summary, and upload training.

Training data include heart rate, calories, effort, and steps records. Summaries include (min, avg, and max) values for the given records.

If the sensor has no steps measurement, the steps and summaries won't be passed.

In the background, uploads the current training as well as any other trainings pending to be uploaded to the RookMotion Server.



### RMTrainingManager class

```swift
open class RMTrainingManager: UIViewController
```
The developer can inherence from this class that provides automated methods to perform trainings using Bluetooth sensors handling all the involved steps, storage, and processing of the training data, and upload to server.


#### Properties

| Name | Type | Description |
| ---- | ---- | ----------- |
| trainingSensor | ```CBPeripheral?``` | Reference to sensor that will be used for training. |
| sensorList | ```[CBPeripheral]```    | This array of CBPeripheral contains the discovered sensors around the device. |
| storageManager | [RMStorageManager](#user-content-rmstoragemanager) | This is a instance of the RMStorageManager class that allows to access to storage methods. |
|  training | [RMTrainingInfo](#user-content-rmtriaininginfo) | This model object of realm that contains all the data of a training |
|sensorManager | [RMSensorManager.shared()](#user-content-rmsensormanager-class) | Reference of the singleton instance of the class RMSensorManager|
| duration | ```Float``` | Variable to set the training duration |
| isTrainingActive | ```Bool``` | Variable to know if the training is active or not. |
| isTimerRunning | ```Bool``` | Variable to know if the timer of duration is already running. |
| firstStart | ```Bool``` | Variable to know if it is the first start of the training. |

#### Methods

| Returns      | Function |
| ----------- | ----------- |
| void | ```startTraining()``` |
| void | ```connectSensor(_ sensor : CBPeripheral)``` |
| void | ```finishTraining(sensor: CBPeripheral?)``` |
| void | ```cancelTraining(sensor: CBPeripheral?)``` |
| void | ```loadUnfinishedTraining()```|
| void | ```pauseTraining()``` |
| void | `storeBicycleRecord(resistance: Float, cadence: Int, power: Float)` |

#### startTraining()

```swift
public func startTraining()
```

**Note: A user have to be stored in the local data in order to perform this  action, if there is not user stored, the calories and the heart rate effort will  not be calculated**

Automates the Bluetooth methods for sensor discovery, selection, connection, re-connection, notification enabling, and data recording. While the stop method is not called, this process will keep the sensor connected and notifying, in case of disconnection a reconnection process will be performed.

Every time the sensor send information, the training data will be generated and available in the [override methods](#user-content-override-methods)

Training data includes training duration, heart rate, steps, calories, effort...  If the sensor has no steps measurement, the steps will be 0.

Note: Before calling this method it is recommended to establish a connection with a sensor using [connectSensor](#user-content-connectsensor) and configure the [training](#user-content-rmtraininginfo) object

##### Example
```swift

class TrainingClass: RMTrainingManager {
    // This sensor was declared just for example purposes
    let sensorToConnect : CBPeripheral?
    let trainingTypeUUID : String?

    override func viewDidLoad() {
        super.viewDidLoad()
        connectSensor(sensor: sensorToConnect)
        trainingSensor = sensor
        training.trainingTypeUUID = trainingTypeUUID
        training.startTraining()
    }

}

```

#### connectSensor()

```swift
public func connectSensor(_ sensor : CBPeripheral)
```

Starts a connection with a given peripheral, when the connection is established, the callback methods will return the sensor data

##### Example
```swift

class TrainingClass: RMTrainingManager {
    // This sensor was declared just for example purposes
    let sensorToConnect : CBPeripheral?

    override func viewDidLoad() {
        super.viewDidLoad()
        connectSensor(sensor: sensorToConnect)
        trainingSensor = sensor
    }

    override func displayHrMeasurements(hrData: RMHrDerivedRecord) {
        print(hrData)
    }

}

```

#### finishTraining()

```swift
public func finishTraining(sensor: CBPeripheral?)
```
Automates the Bluetooth methods for sensor disconnection, training data summary, and upload training.

Training data include heart rate, calories, effort, and steps records. Summaries include (min, avg, and max) values for the given records.

If the sensor has no steps measurement, the steps and summaries won't be passed.

In the background, uploads the current training as well as any other trainings pending to be uploaded to the RookMotion Server.

Note: To upload a training successfully a [RMUser](#user-content-rmuser) needs to be stored in the local database with an available UUID, the [RMApi class](#api) contains the [addUser](#user-content-adduser-api) and [getUserStatus](#user-content-getuserstatus) both methods retrieve the UUID of the user and the [RMClass](#user-content-rmclass) contains the [addUser](#user-content-rm-adduser) method that creates a new user on the server and stores the information in the local database, also the [readUserInfo](#user-content-readuserinfo) returns the [RMUser](#user-content-rmuser) stored.

##### Example
```swift
class TrainingClass: RMTrainingManager {
    // This sensor was declared just for example purposes
    let sensorToConnect : CBPeripheral?

    override func viewDidLoad() {
        super.viewDidLoad()
        connectSensor(sensor: sensorToConnect)
        trainingSensor = sensorToConnect
        training.startTraining()
    }

    @objc func stopTraining() {
        let resultsTraining = ResultsTrainingViewController()
        resultsTraining.training = self.training
        finishTraining(sensor: self.trainingSensor)
        performSegue(withIdentifier: "showResults", sender: nil)
    }

}

```

#### pauseTraining()

Stops the cuurrent workout.

Note:  The method ```startTraining()``` could be used to continue with the training

```swift
public func pauseTraining()
```
##### Example
```swift

class TrainingClass: RMTrainingManager {
    // This sensor was declared just for example purposes
    let sensorToConnect : CBPeripheral?
    let trainingTypeUUID : String?

    override func viewDidLoad() {
        super.viewDidLoad()
        connectSensor(sensor: sensorToConnect)
        trainingSensor = sensor
        training.trainingTypeUUID = trainingTypeUUID
        training.startTraining()
    }

    @objc func pauseButtonTap() {
        pauseTraining()
    }

}

```

#### loadUnfinishedTraining()

If the application is terminated, there is a method that loads the training data, the training data could be loaded with the [RMStorageManager class](#user-content-rmstoragemanager-class)

##### Example
```swift
class TrainingClass: RMTrainingManager {

    override func viewDidLoad() {
        super.viewDidLoad()
        guard let unfinishedTrainings = storageManager.getUnfinishedTrainings() else { return }
        if let trainingToContinue = unfinishedTrainings.first {
            self.training = trainingToContinue
            self.loadUnfinishedTraining()
        }
    }
}
```

#### storeBicycleRecord

If the training is active, the method will add a `RMBicycleDataRecords` object in the records property of the training.

```swift
public func storeBicycleRecord(resistance: Float, cadence: Int, power: Float)
```

#### Override methods

If a class inherits from RMTrainingManager class, the next methods will be available to override, these methods can be used to display the training data.

| Returns      | Function |
| ----------- | ----------- |
| void | ```displayHrMeasurements(hrData: RMHrDerivedRecord)``` |
| void | ```displayStepsMeasurements(stepDerivedData: RMStepDerivedRecord)``` |
| void | ```displayBatteryLevel(batteryLevel: Int)``` |
| void | ```displaySensorProperties(rmSensor: CBPeripheral)``` |
| void | `handleSensorDisconnected()` |

If there is a connection with a sensor, the above methods will be called whenever new data of [RMHrDerivedRecord](#user-content-rmhrderivedrecord), [RMStepDerivedRecord](#user-content-rmstepderivedrecord) or battery level is available.

The `handleSensorDisconnected` method is called, when a disconnection occurs with the sensor.

##### Example
```swift
class TrainingClass: RMTrainingManager {
    // This sensor was declared just for example purposes
    let sensorToConnect : CBPeripheral?

    override func viewDidLoad() {
        super.viewDidLoad()
        connectSensor(sensor: sensorToConnect)
        trainingSensor = sensorToConnect

    }

    override func displayHrMeasurements(hrData: RMHrDerivedRecord) {
        print(hrData)
    }

    override func displayStepsMeasurements(stepDerivedData: RMStepDerivedRecord) {
        print(stepDerivedData)
    }

    override func displayBatteryLevel(batteryLevel: Int) {
        print(batteryLevel)
    }

    override func displaySensorProperties(rmSensor: CBPeripheral) {
        print(rmSensor)
    }
    override func handleSensorDisconnected() {
        print("sensor disconnected")
    }

}
```

### RMBasalCalculator class

The RMBasalCalculator class allows to get the resting heart rate of a user.

```swift
public class RMBasalCalculator: NSObject
```
#### Properties

| Name | Type | Description |
| ---- | ---- | ----------- |
| sensorAcquisition | `CBPeripheral?` | Reference to the sensor that will be used for measure the resting heart rate. |
| sensorManager | `RMSensorManager.shared` | Reference of the singleton instance of the class RMSensorManager |
| isAcquisitionActive | `Bool` | Variable to know if the acquisition is active. |
| sensorList | `[CBPeripheral]` | This array of CBPeripheral contains the discovered sensors around the device. |

#### Methods

| Function      | Description |
| ----------- | ----------- |
| `startAcquisition(with sensor: CBPeripheral, duration: Int = 180)` | Starts the acquisition to calculate the resting heart rate.  |
| `stopAcquisition()` | Stops the resting heart rate calculation. |
| `connectSensor(_ sensor : CBPeripheral)` | Starts a connection with a sensor. |

#### startAcquisition()

Starts the acquisition to calculate the resting heart rate.

```swift
public func startAcquisition(with sensor: CBPeripheral, duration: Int = 180)
```

#### stopAcquisition()

Stops the resting heart rate calculation.

```swift 
public func stopAcquisition()
```

#### connectSensor()

Starts a connection with a sensor.

```swift
public func connectSensor(_ sensor : CBPeripheral)
```

#### Callbacks

A set of methods that provide the data related to the resting heart rate.

```swift
public protocol RMBasalCalculatorDelegate
```

|Function| Description|
|-------|------------|
| `restingHr(didEndCollectData: RestingHearRateSample)` | This method is called when the acquisition end. |
| `restingHr(didChangeHeartRate: RestingHearRateSample)` | This method is called every time a new sample is collected |
| `restingHr(secondsLeft: Int)` | Returns the seconds left of the acquisition. |


###  Network.class

```swift
public class Network
```
Provides methods for network or internet actions

| Returns      | Function |
| ----------- | ----------- |
| ```Bool```  | ```internetIsAvailable()``` |
| ```Bool```  | ```apiIsAlive() ```  |


### internetIsAvailable()
```swift
public func internetIsAvailable() -> Bool
```
This function is used to know if internet connection is available (mobile or wifi).
##### Example
```swift
let network  = Network()

let internetIsAvailable = network.internetIsAvailable()

if internetIsAvailable {
    //code
}
```

###  apiIsAlive()
```swift
public func apiIsAlive() -> Bool
```

This function is used to know if the RookMotion server is available this may help you to know if the developer can send or receive data and establish communication with the server.

##### Example
```swift
let network  = Network()

let serverIsAlive = network.apiIsAlive()

if serverIsAlive {
    //code
}
```

### RMApi class

```swift
public class RMApi
```

Provides methods to interact with the RookMotion server. Involves CRUD actions for users, sensors, trainings and centers.

1. [User](#user-content-user-api)
2. [Sensor](#user-content-sensor-api)
3. [Training](#user-content-training-api)
4. [Centers](#user-content-centers-api)
5. [RookRemote](#user-content-rookremote-api)
6. [Gamification](#user-content-gamification-api)


###  User api

| Function      | Description |
| ----------- | ----------- |
| ```addUser(email: String, completion: @escaping (Int,String) -> Void)``` | Creates a new user on the RookMotion server for the email provided. Returns a RookMotion user_uuid used for all the subsequent request. |
| ```deleteUserToRookMotion(UUID: String,completion: @escaping (Int) -> Void)``` | Delete a user on the RookMotion server for the UUID provided |
|``` getUserStatus(email: String, completion: @escaping (Int,Int) -> Void) ```| Returns basic information about the user's status such as user_uuid, last_login_at, password_updated_at,|
| ```addUserPhysiologicalVariables(weight: Double, height: Double, resting_heart_rate: Int, userUUID: String, completion: @escaping (Int,String) -> Void)```| Adds a new set of physiological variables to a user for the userUUID provided|
| ```retrieveUserPhysiologicalVariables(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)``` | Returns an json string array of user's physiological variables, If a range of dates is given, it will return the json string array between the dates. |
|```getUserInformation(UUID: String, completion: @escaping (Int,String) -> Void)```| Returns a json string with basic information of the user for the UUID provided |
| ```updateUserInformation(userUUID: String, name: String, last_name: String?, mother_last_name: String?, birthday: String, sex: String, completion: @escaping (Int,String)``` | Updates the user's information on the RookMotion server |



#### addUser() api
```swift
public func addUserToRookMotion(email: String, completion: @escaping (Int,String) -> Void)
```
Creates a new user on the RookMotion server for the email provided.
Returns a RookMotion user_uuid used for all the subsequent requests.

##### Example
```swift
let apiManager  = RMApi()
let myUserEmail = "user@email.com"

apiManager.addUser(email: myUserEmail) { (httpCode, uuid) in
    print("Your rookmotion uuid is \(uuid)")
}
```

#### deleteUserToRookMotion()
```swift
public func deleteUserToRookMotion(UUID: String,completion: @escaping (Int) -> Void)
```
Delete a user on the RookMotion server for the UUID provided.

##### Example
```swift
let apiManager  = RMApi()
let userUUID = "1111-2222-3333-4444"

apiManager.deleteUserToRookMotion(UUID:: userUUID) { (httpCode) in
    print(httpCode)
    //if the status code was 204, the user has been deleted
}
```
#### getUserStatus()

```swift
getUserStatus(email: String, completion: **@escaping** (Int,String) -> Void)
```
Returns a json string with basic information about user's status.

##### Example
```swift
let apiManager = RMApi()
let emailUser = "test@email.com"
apiManager.getUserStatus(email: userTestEmail) { (httpCode,response) in
    print(response)
}
```

##### Response example

```json
{
    "email_verified_at" : "2021-06-11 11:25:02",
    "last_login_at" : "1969-12-31 18:00:00",
    "password_updated_at" : "1969-12-31 18:00:00",
    "user_created_on" : null,
    "user_status" : 1,
    "user_uuid" : "66bbb787-1234-1234-1234-a44457dfe180",
    "profile_filled_at" : "2020-01-16 00:00:00",
    "payment_status" : null
}
```
#### addUserPhysiologicalVariables()
```swift
public func addUserPhysiologicalVariables(weight: Double, height: Double, resting_heart_rate: Int, userUUID: String, completion: @escaping (Int,String) -> Void)
```

Updates the user's information and physiological variables.

##### Example
```swift
let apiManager  = RMApi()
let userUUID = "1111-2222-3333-4444"

apiManager.addUserPhysiologicalVariables(weight: 70.0, height: 170.0, resting_heart_rate: 60, userUUID: userUUID) { (httpCode, response) in
    //If httpCode was equal to 201, the physiological variables has been added to the user
}
```

#### retrieveUserPhysiologicalVariables()

```swift
public func retrieveUserPhysiologicalVariables(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)
```

Returns an json string array of user’s physiological variables, If a range of dates is given, it will return the json string array between the dates.

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

let day = DateComponents(day: -7)
guard let startDate = Calendar.current.date(byAdding: day, to: Date()) else { return }
let endDate = Date()

apiManager.retrieveUserPhysiologicalVariables(userUUID: userUUID, from: startDate, to:  endDate) { (httpCode, arrayPhy, arrayCount) in
print("Debug response \(arrayPhy)")

}

```

##### Response example

```json
[
  {
    "datetime": "2021-06-24 15:21:36",
    "resting_heart_rate": "60.00",
    "weight": "76.00",
    "height": "170.00"
  },
  {
    "datetime": "2021-06-24 15:30:45",
    "resting_heart_rate": "60.00",
    "weight": "75.00",
    "height": "170.00"
  },
  {
    "datetime": "2021-06-24 15:31:10",
    "resting_heart_rate": "60.00",
    "weight": "76.00",
    "height": "170.00"
  }
]
```

####  getUserInfotmation()

Returns a json string with basic information of the user for the UUID provided

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"
apiManager.getUserInformation(UUID: userUUID) { (httpCode,response) in
    print(response)
}
```

##### Response example

```json
{
    "user_uuid": "36ddd602-1111-2222-3333-a44457dfe180",
    "name": "paco",
    "last_name_1": "test",
    "last_name_2": "test",
    "email": "test@email.com",
    "birthday": "1994-06-15",
    "sex": "male",
    "physiological_variables": {
        "weight": "71.00",
        "height": "171.00",
        "resting_heart_rate": "60.00"
        }
}
```

#### updateUserInformation()

```swift
updateUserInformation(userUUID: String, name: String,
                      last_name: String?, mother_last_name: String?,
                      birthday: String, sex: String,
                      completion: @escaping (Int,String) -> Void)
```

Updates the user's information on the RookMotion server.

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"
apiManager.updateUserInformation( userUUID: userUUID, name: "PruebaFW", last_name: "last name", mother_last_name: "last name 2", birthday: "1990-12-12", sex: "male") { (httpCode, JSONString) in
    print("\(httpCode) \(JSONString)")
}
```

### Sensor api

| Function    | Description |
| ----------- | ----------- |
| ```addSensorToUser(sensor_name: String, sensor_mac: String, ownership_type: String, userUUID: String, completion: @escaping (Int,String) -> Void)``` | Adds a new user's sensor on the RookMotion server. |
|```retrieveSensorsFromUser(userUUID: String , completion: @escaping (Int,String,Int) ->Void)```| Returns a list of the user's sensors.|
| ```removeUserSensor(userUUID: String,sensorUUID: String,completion: **@escaping** (Int) ->Void)``` | Removes a user's sensor for the provided userUUID and sensorUUID. |

#### addSensorToUser()
```swift
addSensorToUser(sensor_name: String, sensor_mac: String, ownership_type: String,
userUUID: String, completion: @escaping (Int,String) -> Void)
```
Adds a new user's sensor on the RookMotion server, it's created with the sensorName.
Returns a RookMotion sensor_uuid used for all the subsequent requests.

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

apiManager.addSensorToUser(sensor_name: "prueba_sensor-00º", sensor_mac: "CC:AA:AA:AA:AA:AA", ownership_type: "owned", userUUID: userUUID) { (httpCode, sensor_uuid) in
    print("Your sensor id is \(sensor_uuid)")
}
```

#### getSensorsList()
```swift
public func retrieveSensorsFromUser(userUUID: String , completion: **@escaping** (Int,String,Int) ->Void)
```

Retrieves a json string array that contains a list  of the user's sensors.

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

retrieveSensorsFromUser(userUUID: userTestUUID) { (httpCode, sensorList, count) in
    print("DEBUG: \(sensorList)")
}
```

##### Response example
```json
[
    {
        "sensor_name" : "HW702A-0582625",
        "updated_at" : "2021-06-14 19:18:23",
        "ownership_type" : "owned",
        "sensor_mac" : null,
        "sensor_uuid" : "503b10be-2222-2222-2222-d9e785373ce6"
    },
    {
        "sensor_name" : "RkHRam 0805138",
        "updated_at" : "2021-06-30 13:41:36",
        "ownership_type" : "owned",
        "sensor_mac" : "E3:00:A0:9E:86:0C",
        "sensor_uuid" : "62710e70-1111-1111-1111-fb5a2f0ae23c"
    },
    {
        "sensor_name" : "Rook i-0162733",
        "updated_at" : "2021-06-11 11:31:53",
        "ownership_type" : "owned",
        "sensor_mac" : null,
        "sensor_uuid" : "ace8cd2b-3333-3333-3333-ef07ed0f27e2"
    }
]
```

#### removeUserSensor()

```swift
removeUserSensor(userUUID: String,sensorUUID: String,completion: @escaping (Int) ->Void)
```

Removes a user's sensor for the provided userUUID and sensorUUID.

##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"
let sensorUUID = "ace8cd2b-3333-3333-3333-ef07ed0f27e2"

apiManager.removeUserSensor(userUUID: userUUID, sensorUUID: sensorUUID) { (httpCode) in
    //If httpCode was equal to 204, the user sensor has been removed.

}

```

### Training api

| Function      | Description |
| ----------- | ----------- |
| ```retrieveTrainingTypes( completion: @escaping (Int,String,Int) -> Void)``` | Returns a json string array that contains a list of trainings. |
| ```addTrainingToUser(userUUID: String, training: RMTrainingRetrived, completion : @escaping (Int, String, String) -> Void)``` | Adds a new training to the user for the provided UUID. |
| ```retrieveTrainingsFromUser(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)``` | Returns a json string array that contains a list of the user's trainings, if a start date an end date are provided, it will return the trainings between those dates. |
|``` getTrainingInformation(trainingUUID: String, completion: @escaping (Int, String?) -> Void) ```| Returns the summaries of a training for the provided UUID. |
| ```deleteTrainingRookMotion(trainingUUID: String,completion: @escaping (Int) -> Void)```| Removes the training for the provided UUID from RookMotion server.|
| ```retrieveUserRewards(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)``` | Returns a json string array of the user's rewards, if a range of dates is provided, the json string will contain all the rewards between the given dates |


#### retrieveTrainingTypes()

Returns a json string array that contains a list of trainings

```swift
public func retrieveTrainingTypes( completion: @escaping (Int,String,Int) -> Void)
```
##### Example
```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

apiManager.retrieveTrainingTypes{ (httpCode, trainings, count) in
    print(" Debug: ", trainings)
}
```

##### Response example
```json
[
  {
    "training_type_uuid": "1dc7e4e1-8c85-4f06-8bcd-cccbf53ad069",
    "use_heart_rate": 1,
    "trainig_name": "por defecto 1"
  },
  {
    "training_type_uuid": "c2889b5b-e510-4c03-8f28-19460c113da9",
    "use_heart_rate": 1,
    "trainig_name": "por defecto 2",
    "use_gps": 1,
    "use_steps": {
      "steps_types": "jumps",
      "enabled": 1
    }
  },
  {
    "training_type_uuid": "8e4aaa96-fd9d-4097-a6a8-1da637ba1d2b",
    "use_heart_rate": 1,
    "trainig_name": "por defecto 3",
    "use_steps": {
      "steps_types": "steps",
      "enabled": 1
    }
  }
]
```

#### addTrainingToUser()

```swift
addTrainingToUser(userUUID: String, training: RMTrainingRetrived, completion : @escaping (Int, String, String) -> Void)
```

Adds a new training to the user for the UUID provided. The [RMTrainingRetrived](#rm_training_retrived) object is automatically constructed in the class RMTrainingManager.

##### Example

```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

apiManager.addTrainingToUser(userUUID: String, training: RMTrainingRetrived) { (httpCode, response, response description) in
    print(response)
}

```

#### retrieveTrainingsFromUser

```swift
public func retrieveTrainingsFromUser(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)
```

Returns a json string array that contains a list of the user's trainings.

##### Example

```swift
let apiManager = RMApi()
let userUUID = "12bybyb11-1111-1111-1111-mcoienw1"

apiManager.retrieveTrainingsFromUser(userUUID: userTestUUID) { (httpCode, trainingList, trainingCount) in
 print(trainingList)
}

```

##### Example response

```json
[
  {
    "rewards": {
      "calories_points": "0.0000"
    },
    "groupal_mode": 0,
    "device_type": "app",
    "training_type": "por defecto 1",
    "summaries": {
      "cadence_min": "1000.0000",
      "heart_rate_min": "68.0000",
      "effort_avg": "37.0000",
      "z4_cadence_avg": "0.0000",
      "z2_cadence_avg": "0.0000",
      "z1_cadence_avg": "0.0000",
      "z1_steps_tot": "0.0000",
      "z5_calories_tot": "0.0000",
      "duration_time_tot": "14.0000",
      "z3_steps_tot": "0.0000",
      "heart_rate_avg": "72.0000",
      "z5_steps_tot": "0.0000",
      "cadence_avg": "0.0000",
      "effort_max": "40.0000",
      "cadence_max": "0.0000",
      "z5_time_tot": "0.0000",
      "steps_tot": "0.0000",
      "z2_steps_tot": "0.0000",
      "z3_time_tot": "0.0000",
      "z4_time_tot": "0.0000",
      "z1_time_tot": "14.0000",
      "z4_calories_tot": "0.0000",
      "z3_calories_tot": "0.0000",
      "z4_steps_tot": "0.0000",
      "calories_tot": "0.0000",
      "z2_calories_tot": "0.0000",
      "z3_cadence_avg": "0.0000",
      "z1_calories_tot": "0.0000",
      "effort_min": "35.0000",
      "z2_time_tot": "0.0000",
      "heart_rate_max": "76.0000",
      "z5_cadence_avg": "0.0000"
    },
    "training_uuid": "eb982c75-1111-2222-1111-e4f44f7f872e",
    "start": "2021-06-11 11:39:58",
    "end": "2021-06-11 11:40:12",
    "processed": 1
  },...
]
```
#### getTrainingInformation()

```swift
public func getTrainingInformation(trainingUUID: String, completion: @escaping (Int,String?) -> Void)
```

Returns a json string of a training information for the provided UUID.

Note: the trainingUUID can be obtained from [retrieveTrainingsFromUser](#user-content-retrievetrainingsfromuser)

##### Example

```swift
let apiManager = RMApi()
let trainingUUID = ""

apiManager.getTrainingInformation(trainingUUID: trainingUUID) { (httpCode, jsonString) in
    print(jsonString!)
}

```

##### Example response

```json
{
  "end": "2021-06-24 20:27:44",
  "sensor": "Rook i-0162733",
  "start": "2021-06-24 20:27:22",
  "training_type": "por defecto 2",
  "summaries": {
    "z4_steps_tot": "0.0000",
    "z2_cadence_avg": "0.0000",
    "z3_steps_tot": "0.0000",
    "z5_calories_tot": "0.0000",
    "z1_cadence_avg": "16.0000",
    "heart_rate_avg": "76.0000",
    "z4_calories_tot": "0.0000",
    "heart_rate_max": "95.0000",
    "z4_time_tot": "0.0000",
    "z5_time_tot": "0.0000",
    "effort_max": "50.0000",
    "effort_avg": "39.0000",
    "effort_min": "33.0000",
    "z1_calories_tot": "0.0000",
    "cadence_min": "0.0000",
    "cadence_max": "120.0000",
    "z4_cadence_avg": "0.0000",
    "cadence_avg": "48.0000",
    "z3_cadence_avg": "0.0000",
    "steps_tot": "15.0000",
    "z5_cadence_avg": "0.0000",
    "z1_time_tot": "22.0000",
    "z2_time_tot": "0.0000",
    "heart_rate_min": "64.0000",
    "z3_time_tot": "0.0000",
    "calories_tot": "0.0000",
    "z3_calories_tot": "0.0000",
    "z2_steps_tot": "0.0000",
    "duration_time_tot": "22.0000",
    "z1_steps_tot": "15.0000",
    "z5_steps_tot": "0.0000",
    "z2_calories_tot": "0.0000"
  },
  "rewards": {
    "calories_points": "0.0000"
  },
  "groupal_mode": 0,
  "device_type": "app",
  "records": {
    "hr_derived_records": [
      {
        "calories": "0.0100",
        "timestamp": "2021-06-24 20:27:22",
        "heart_rate_variability": "0.0000",
        "heart_rate": "64.0000",
        "effort": "33.7900"
      },
      {
        "calories": "0.0200",
        "timestamp": "2021-06-24 20:27:23",
        "heart_rate_variability": "0.0000",
        "heart_rate": "64.0000",
        "effort": "33.7900"
      },
      {
        "calories": "0.0300",
        "timestamp": "2021-06-24 20:27:24",
        "heart_rate_variability": "0.0000",
        "heart_rate": "64.0000",
        "effort": "33.7900"
      }
    ],
    "steps_derived_records": [
      {
        "steps": "0.0000",
        "cadence": "0.0000",
        "timestamp": "2021-06-24 20:27:31"
      },
      {
        "steps": "0.0000",
        "cadence": "0.0000",
        "timestamp": "2021-06-24 20:27:34"
      }
    ]
  }
}

```

#### deleteTrainingRookMotion()

```swift
public func deleteTrainingRookMotion(trainingUUID: String,completion: @escaping (Int) -> Void)
```

Removes the training for the provided UUID from RookMotion server.

##### Example

```swift
let apiManager = RMApi()
let trainingUUID = ""

apiManager.deleteTrainingRookMotion(trainingUUID: String) { (httpCode) in
    // If httpCode was equal to 204, the training has been removed.
}

```

#### retrieveUserRewards()

```swift
retrieveUserRewards(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil ,completion: @escaping (Int,String,Int) ->Void)
```
Retrieves a list of user's rewards during the specified period.

##### Example
```swift
let apiManager = RMApi()
let userUUID = ""

let day = DateComponents(day: -7)
guard let startDate = Calendar.current.date(byAdding: day, to: Date()) else { return }
let endDate = Date()

apiManager.retrieveUserRewards(userUUID: userTestUUID, from: startDate, to:  endDate) { (httpCode, rewardList, rewardCount) in
    print(rewardList)
}

```

##### Example response

```json
[
  {
    "training_uuid": "dc5764ae-1111-1111-1111-2711fb6da57f",
    "calories_points": "0.0000"
  },
  {
    "training_uuid": "9d92e594-2222-2222-2222-686d5001a53a",
    "calories_points": "0.0000"
  },
  {
    "training_uuid": "eaaa0ce6-333-3333-3333-cd308feef5fb",
    "calories_points": "0.0083"
  }
]
```

### Centers api

| Function      | Description |
| ----------- | ----------- |
| `getClientCenters(completion: @escaping (Int, String?) -> Void)` | Returns a json string with all the centers registered in the roomMotion server. |
| `retrieveRegisteredCentersForUser(userUUID: String, completion: @escaping (Int,String?) -> Void)` | Returns a json string with a user's registered rooms. |
| `linkUserToCenterRooms(userUUID: String, branchUUID: String, roomsUUID: [String]?, completion: @escaping (_ httpCode: Int, _ response: String?) -> Void))` | Sends a request to link a user in the rooms for the given UUIDs. |
| `unlinkUserFromBranch(userUUID: String, branchUUID: String, completion: @escaping (_ httpCode: Int) -> Void)` | Unlinks a user from room for the room UUID given. |

#### getClientCenters()

```swift
public func getClientCenters(completion: @escaping (Int, String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()

apiManager.getClientCenters() { (httpCode, jsonString) in
    print(jsonString ?? "-")
}

```

##### Example Response

```json
[
  {
    "name": "sucursal uno",
    "rooms": [
      {
        "required_confirmation": 0,
        "description": null,
        "uuid": "1b1e99e1-ee15-4ed0-af08-3dd2e3d26b08",
        "name": "room dos"
      },
      {
        "required_confirmation": 1,
        "description": null,
        "uuid": "74c0c57d-afb1-4f94-8691-8940a4893bf4",
        "name": "room uno"
      }
    ],
    "contacts": [
      {
        "email": "persona1@rookmotion.com",
        "contact_person_name": "persona 1",
        "uuid": "611a7001-dd44-43bb-9618-4f4525e23f0e",
        "contact_area": "soporte 1",
        "phone": "55555555"
      },
      {
        "email": "persona2@rookmotion.com",
        "contact_person_name": "persona 2",
        "uuid": "44b142e6-c11f-47a3-b80f-e7321fef64d0",
        "contact_area": "soporte 2",
        "phone": "55555555"
      },
      {
        "email": "persona3@rookmotion.com",
        "contact_person_name": "persona 3",
        "contact_area": "soporte 3",
        "phone": "55555555",
        "uuid": "2777caf6-6478-4f79-ba5d-8b61e9fba44d"
      },
      {
        "email": "persona4@rookmotion.com",
        "contact_person_name": "persona 4",
        "contact_area": "soporte 4",
        "phone": "55555555",
        "uuid": "29705df7-b444-4356-96fe-6e648cda42f7"
      }
    ],
    "multimedia": [
      {
        "media_type": "image",
        "name": "eyU69phf1tXKpXAbJZnd2MQ1p5OGRy5QDjtlDeKJ.jpg",
        "url": "https://api2.rookmotion.rookeries.dev/storage/images_branch/eyU69phf1tXKpXAbJZnd2MQ1p5OGRy5QDjtlDeKJ.jpg",
        "usage_type": "gallery",
        "uuid": "28e78c33-680e-4ee8-8f7d-b04cef64dc58"
      },
      {
        "media_type": "image",
        "name": "Z7s70zpu5Xb0jTHM4PXD9RkteQMOj9yP3AkcbQTD.jpg",
        "url": "https://api2.rookmotion.rookeries.dev/storage/images_branch/Z7s70zpu5Xb0jTHM4PXD9RkteQMOj9yP3AkcbQTD.jpg",
        "usage_type": "gallery",
        "uuid": "1a306922-cf90-400f-9a49-2c0f9a563558"
      }
    ],
    "location": {
      "city": "miguel hidalgo",
      "uuid": "8abfe783-89f6-4bbb-9832-90006a6212b7",
      "address_line_2": null,
      "location_point": "19.453903328596336, -99.20001526137233",
      "country": "méxico",
      "state": "ciudad de méxico",
      "zip_code": "11289",
      "address_line_1": "ignacio allende 21, amp torre blanca",
      "address_line_3": null
    },
    "description": "sucursal uno",
    "uuid": "32dd9553-528d-4dc1-9ec7-a31f0d7a8251"
  },
  {
    "multimedia": [],
    "name": "sucursal dos",
    "contacts": [],
    "rooms": [
      {
        "name": "room cuatro",
        "uuid": "eeeb5810-a410-45b3-8077-b2e56c3b7563",
        "description": null,
        "required_confirmation": 0
      },
      {
        "name": "room tres",
        "uuid": "2826922f-3fda-4942-8b80-945a88045b80",
        "description": null,
        "required_confirmation": 1
      }
    ],
    "description": "sucursal dos",
    "uuid": "d42d89e7-5fed-43c6-8133-b71b3d617fef"
  },
  {
    "contacts": [],
    "multimedia": [],
    "description": "sucursal tres",
    "uuid": "2943dbbb-fcbd-4e41-a89b-ab1ef87387a1",
    "name": "sucursal tres",
    "rooms": [
      {
        "name": "room cinco",
        "description": null,
        "required_confirmation": 1,
        "uuid": "c22f83a3-5307-497e-ac33-26fecfd3ff06"
      },
      {
        "name": "room seis",
        "description": null,
        "required_confirmation": 0,
        "uuid": "45286157-85e4-426b-9c4e-af2cc7348e2c"
      }
    ]
  }
]
```

Returns a json string with all the centers registered in the roomMotion server.

#### retrieveRegisteredCentersForUser()

```swift
public func retrieveRegisteredCentersForUser(userUUID: String, completion: @escaping (Int,String?) -> Void)
```

Returns a json string with a user's registered rooms.

##### Example

```swift
let apiManager = RMApi()

apiManager.retrieveRegisteredCentersForUser(userUUID: "36d11602-1111-2222-3333-afff57dfe180") { (httpCode, jsonString) in
    print(jsonString ?? "-")
}

```

##### Example Response

```json
[
  {
    "chain": {
      "branch": {
        "branch_uuid": "32dd9553-528d-4dc1-9ec7-a31f0d7a8251",
        "users_room": [
          {
            "room_uuid": "1b1e99e1-ee15-4ed0-af08-3dd2e3d26b08",
            "room_name": "room dos",
            "status": "pending"
          },
          {
            "room_uuid": "74c0c57d-afb1-4f94-8691-8940a4893bf4",
            "room_name": "room uno",
            "status": "link"
          }
        ],
        "branch_name": "sucursal uno"
      },
      "chain_name": "rookmotion uno",
      "chain_uuid": "31165910-6545-4268-8bf4-92e7475ae9a9"
    }
  },
  {
    "chain": {
      "branch": {
        "branch_uuid": "d42d89e7-5fed-43c6-8133-b71b3d617fef",
        "users_room": [
          {
            "status": "pending",
            "room_name": "room cuatro",
            "room_uuid": "eeeb5810-a410-45b3-8077-b2e56c3b7563"
          }
        ],
        "branch_name": "sucursal dos"
      },
      "chain_uuid": "31165910-6545-4268-8bf4-92e7475ae9a9",
      "chain_name": "rookmotion uno"
    }
  }
]
```

#### linkUserToCenterRooms()

```swift
linkUserToCenterRooms(userUUID: String, branchUUID: String, roomsUUID: [String]?,
            completion: @escaping (_ httpCode: Int, _ response: String?) -> Void)
```

Sends a request to link a user in the rooms for the given branch UUID

##### Example

```swift
let apiManager = RMApi()
let branchTestUUID = "fiuh2-122-3234-fwefw"
apiManager.linkUserToCenterRooms(userUUID: "3111bb602-1111-2222-3333-afff57dfesss", branchUUID: branchTestUUID ,roomsUUID: nil) { (httpCode, jsonString) in
    print(jsonString)
}

```

#### unlinkUserFromBranch()

```swift
public func unlinkUserFromBranch(userUUID: String, branchUUID: String, completion: @escaping (_ httpCode: Int) -> Void)
```

Unlinks a user from branch for the UUID given.

##### Example

```swift
let apiManager = RMApi()
let branchTestUUID = ""
let userUUID = ""

apiManager.unlinkUserFromBranch(userUUID: userUUId, branchUUID: branchTestUUID) { httpCode in
    //if httpCode was 204, the branch has been removed.
}

```

###  Rookremote api

##### note: To use these methods the url remote has to be set with the RMSettings class

```swift
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        // Override point for customization after application launch.
        let clientKey = "YOUR_KEY"
        let tokenLevel = "YOUR_TOKEN"
                let urlBase = "YOUR_BASE_URL"
                let urlRemote = "YOUR_REMOTE_URL"

        RMSettings.shared.setCredentials(client_key: clientKey, token: tokenLevel)
                RMSettings.shared.setUrlApi(with: urlBase)
                RMSettings.shared.setUrlRemote(with: urlRemote)

        return true
    }
```



| Function      | Description |
| ----------- | ----------- |
| `retrieveRemoteRooms(userUUID: String, completion: @escaping (_ httpCode: Int, _ response: String?) -> Void)` | Return a list of the remote rooms available. |
| `connectUserToClass(classUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Send a request to connect a user to a remote class |
| `sendRealTimeData(user: RMUser, imageUserUrl: String? = nil, pseudonym: String, stepsTot: Int, caloriesTot: Int, hr: Int, effort: Int, classUUID: String, retriveUsersList: Bool = false , completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Send the real time data of a training to the remote class connected. |
| `disconnectUserFromClass(classUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Sent a request to disconnect a user from a remote class. |
| `isUserLinkedToBranch(branchUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Returns a status code if the user in linked to a center |
| `getRemoteRoomInfo(roomUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?,_ remoteClass: RemoteClasInfo?) -> Void)` | Returns a json string object with the information of a remote class |
| `autoLinkUserToCenter(userUUID: String, branchUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Links a user to a center, with this method the center does not have to accept the user. |


#### retrieveRemoteRooms

```swift
public func retrieveRemoteRooms(userUUID: String, completion: @escaping (_ httpCode: Int, _ response: String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()
let roomTestUUID = ""
let userUUID = ""

apiManager.retrieveRemoteRooms(userUUID: userUUID) { httpCode, jsonResponse in
    print(jsonResponse)
}

```

##### Response example

```json
[
  {
    "chain": {
      "chain_uuid": "1de3adf5-b9fe-4cc4-ba70-c7bec7bf43ea",
      "chain_name": "rookmotion",
      "branch": {
        "uuid": "b570ed23-5fb0-4a86-a7e6-2346444767f7",
        "name": "Rookmotion sum",
        "status": "link",
        "rooms": [
          {
            "id": 1,
            "uuid": "fdd193f6-180f-446a-bd3d-fc536f60f242",
            "name": "daq principal",
            "description": "daq principal",
            "type_room": "daq"
          },
          {
            "id": 74,
            "uuid": "0ec6382e-29e1-43d5-a42e-7548035a46cf",
            "name": "test",
            "description": null,
            "type_room": "remote",
            "training_type": "kangoo",
            "training_type_uuid": "9c1436dd-16c0-4c56-bb43-b8dd83f0be12",
            "use_steps": 1,
            "step_options": "boots",
            "configuration_uuid": "e23e6fd3-723e-4855-a5c6-e17f07dc3016",
            "channel": "chanel_4OtT40NWrXmrqD8rx0kmpKPyJCbNCO1",
            "duration": 14,
            "capacity": 2,
            "class_delay": 0,
            "data_order": "calories",
            "remote_state": 2
          },
          {
            "id": 75,
            "uuid": "cf42803e-3613-427b-bc5e-02a49ae3bcde",
            "name": "test-ban",
            "description": null,
            "type_room": "remote"
          }
        ]
      }
    }
  }
]
```

##### note: If the value of the key "remote_state" is equal to 2, the remote room is available.

#### ConnectUserToClass

```swift
public func connectUserToClass(classUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?)
```

##### Example

```swift
let apiManager = RMApi()
let roomTestUUID = ""
let userUUID = ""
let classUUID = ""

apiManager.connectUserToClass(classUUID: classUUID, userUUID: userUUID) { httpCode, jsonResponse in
    print(jsonResponse)
}

```

##### Response example

###### user accepted

```json
{
    "result": "added",
    "remaining_places": 0,
    "remaining_waiting_seconds": 0
}
```

###### the class is full

```json
{
    "result": "the Remote is full"
}
```

#### sendRealTimeData

```swift
sendRealTimeData(user: RMUser, imageUserUrl: String? = nil, pseudonym: String, stepsTot: Int, caloriesTot: Int, hr: Int, effort: Int, classUUID: String, retriveUsersList: Bool = false , completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()
let user = RMUser()
let classUUID = ""

apiManager.sendRealTimeData(user: user, imageUserUrl: "urlImage" ,
                            pseudonym: user.pseudonym,  stepsTot: 10,
                            caloriesTot: 100, hr: 60, effort: 34, classUUID: classUUID) { httpCode, jsonResponse in
    print(jsonResponse)
}
```

If the parameter `retriveUserList` is set with **true**, the end point will return a list of the user in the class

##### Response example

###### measurements accepted
```json
httpCode = 201
{
    "result": "added",
    "remaining_waiting_seconds": 0
}
```

###### measurements accepted whit user list

```json
{
  "result": "added",
  "remaining_waiting_seconds": 0,
  "data": [
    {
      "final_user_uuid": "09af36ca-fae1-ff2e-95a6-uiehfiu033",
      "pseudonym": "usuario 4",
      "email": "usuario4@rookmotion.com",
      "steps_tot": 1,
      "calories_tot": 1,
      "hr": 60,
      "effort": 73,
      "user_url_image": null,
      "status": 1
    }
  ]
}
```

###### user banned from class
```json
httpCode = 300
{
    "result": "No exists user"
}
```

###### class has finished

```json
httpCode = 410
{
    "errors": {
        "date": [
            "date no valid"
        ]
    }
}
```

#### disconnectUserFromClass

```swift
public func disconnectUserFromClass(classUUID: String, userUUID: String,
                     completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()
let user = RMUser()
let classUUID = ""

apiManager.disconnectUserFromClass(classUUID: String, userUUID: String) { (httpCode, _) in
    print("Debug httpCode: \(httpCode)")
}
```

##### Response example

```swift
    "Debug httpCode: 204"
```

#### isUserLinkedToBranch()

The httpCode of the response indicates if the user is linked or not.
If httpCode is equal to 200, the user is linked.
If httpCode is equal to 204, the user is  not linked.

```swift
public  func  isUserLinkedToBranch(branchUUID: String, userUUID: String,
                                     completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()
let user = RMUser()
let branchUUID = "criejr-wfij33-2kn-3222"

apiManager.isUserLinkedToBranch(branchUUID: String, userUUID: String) { (httpCode, _) in
    print("Debug httpCode: \(httpCode)")
}
```

##### Response example

```swift
    "Debug httpCode: 204"
```

#### getRemoteRoomInfo()

Returns a json string and a `RemoteClasInfo`object with the room information

```swift
public  func  getRemoteRoomInfo(roomUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?,_ remoteClass: RemoteClasInfo?) -> Void)
```
##### Example

```swift
let apiManager = RMApi()
let user = RMUser()
let branchUUID = "criejr-wfij33-2kn-3222"

apiManager.getRemoteRoomInfo(roomUUID: String) { (httpCode, jsonResponse, RemoteClass) in
    print("Debug resposne: \(jsonReponse)")
}
```

##### Response example

```json
{
"room_uuid": "dbb59776-055a-435f-8294-474d13d582e6",
"room_name": "tres",
"configuration_class_uuid": "224d4ec2-fd8e-44fc-bab5-98cb4e8b2206",
"duration": 5,
"capacity": 5,
"class_delay": 1,
"training_type_uuid": "7ddafe63-50cb-4024-a39b-39bbd40e19bd",
"training_name": "trampolín",
"use_steps": 1,
"step_options": "trampoline",
"meet_number": null,
"meet_password": null
}
```


#### autoLinkUserToCenter()

Auto links a user to a center.

```swift
public func autoLinkUserToCenter(userUUID: String, branchUUID: String,
                             completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
```

##### Example

```swift
let apiManager = RMApi()
let user = RMUser()
let branchUUID = "criejr-wfij33-2kn-3222"

apiManager.autoLinkUserToCenter(userUUID: String, branchUUID: String) { (httpCode, _) in
    print("Debug httpCode: \(httpCode)")
}
```

### Gamification

##### note: To use these methods the gamification url has to be set with the RMSettings class

```swift
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        // Override point for customization after application launch.
        let clientKey = "YOUR_KEY"
        let tokenLevel = "YOUR_TOKEN"
                let urlBase = "YOUR_BASE_URL"
                let urlRemote = "YOUR_REMOTE_URL"
                let urlGamification = "YOUR_GAMIFICATION_URL"

        RMSettings.shared.setCredentials(client_key: clientKey, token: tokenLevel)
                RMSettings.shared.setUrlApi(with: urlBase)
                RMSettings.shared.setUrlRemote(with: urlRemote)
                RMSettings.shared.setUrlGamification(with: urlGamification)

        return true
    }
```



| Function      | Description |
| ----------- | ----------- |
| ```getUserChallenges(userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)``` | Returns a json string with all the challenges and goals of a user. |
| ```leaveChallenge(challengeUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void) ``` | Sends a request to unsubscribe a user from a challenge. |
| `fetchUserChallenges(userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Retrieves a json string with a list of the active challenges of a user. |
| `getChallengeHistoryOfUser(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Retrieves a json string with a list of the no active challenges of a user, if you provide a start date and an end date, the list will be fetched from that rage of dates. |
| `getChallengeDetails(challengeUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | The method retrieves the details of a challenge. |
| `getRankingFromChallenge(challengeUUID: String, page: Int = 1, completion: @escaping(_ httpCode: Int, _ reponse: String?) -> Void)` | Retrieves the ranking of a challenge. |
| `getUserChallnegeRewardsOfUser(with uuid: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Returns a json string of the rewards earned of a user's challenges |
| `public func exitFromChallenge(challengeUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)` | Removes a user from challenge. |

#### getUserChallenges

Retrieves a json string that contains al the challenges and goals of a user.

```swift 
public func  getUserChallenges(userUUID: String,
                                    completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.getUserChallenges(userUUID: "userUUID") { (httpCode, response) in
    print("user challenges \(response)")
}
```

##### Response example

```json
{
  "message": "Challenges retrieved successfully",
  "data": {
    "individual": [
      {
        "challenge_id": 1,
        "challenge_uuid": "e0b115c2-e05d-4289-a33b-54cd276a9482",
        "branch_uuid": "e8859598-e042-4e23-b3e8-0674f5565ed1",
        "challenge_type_id": 1,
        "challenge_type": "Individual",
        "challenge_modality_id": 1,
        "challenge_modality": "By User",
        "name": "Prueba CS",
        "description": null,
        "status": 1,
        "allow_app": 0,
        "allow_room": 0,
        "device_type": null,
        "start_at": "2022-03-02",
        "finish_at": "2022-04-02",
        "created_at": "2022-03-02 16:30:21",
        "updated_at": "2022-03-02 16:30:21",
        "users_participating": {
          "data": 2
        },
        "position_in_challenge": null,
        "total_goals": {
          "data": 1
        },
        "goals": {
          "data": [
            {
              "id": 1,
              "uuid": "72a01937-ac55-445e-8ab2-c4e48743a236",
              "branch_uuid": "e8859598-e042-4e23-b3e8-0674f5565ed1",
              "goal_type_id": 400,
              "goal_type": "Calories",
              "meta": "5000",
              "points": "2.00",
              "created_at": "2022-03-02 16:30:35",
              "updated_at": "2022-03-02 16:30:35",
              "metrics": {
                "data": [
                  {
                    "id": 28,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "437.00",
                    "created_at": "2022-03-03 05:15:48",
                    "updated_at": "2022-03-03 05:15:48"
                  },
                  {
                    "id": 29,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "437.00",
                    "created_at": "2022-03-03 05:15:48",
                    "updated_at": "2022-03-03 05:15:48"
                  },
                  {
                    "id": 121,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "703.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 123,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "703.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 193,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:33",
                    "updated_at": "2022-03-08 05:20:33"
                  },
                  {
                    "id": 194,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:33",
                    "updated_at": "2022-03-08 05:20:33"
                  },
                  {
                    "id": 201,
                    "challenge_id": 1,
                    "user_id": 84,
                    "goal_id": 1,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            }
          ]
        },
        "total_goals_completed": {
          "data": 0
        },
        "goals_completed": {
          "data": []
        }
      }
    ],
    "group": [
      {
        "challenge_id": 24,
        "challenge_uuid": "edff1503-cca3-4eec-8b8d-47eb38984952",
        "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
        "challenge_type_id": 2,
        "challenge_type": "Group",
        "challenge_modality_id": 2,
        "challenge_modality": "By Team",
        "name": "Reto Marzo",
        "description": null,
        "status": 1,
        "allow_app": 0,
        "allow_room": 0,
        "device_type": null,
        "start_at": "2022-03-06",
        "finish_at": "2022-05-01",
        "created_at": "2022-03-06 05:01:53",
        "updated_at": "2022-03-06 05:01:53",
        "teams_participating": {
          "data": 2
        },
        "team_position": {
          "data": null
        },
        "user_team_position": {
          "data": null
        },
        "total_goals": {
          "data": 6
        },
        "goals": {
          "data": [
            {
              "id": 23,
              "uuid": "83314bfe-1a2b-463a-ade1-24cbf29d0292",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 400,
              "goal_type": "Calories",
              "meta": "5000",
              "points": "10.00",
              "created_at": "2022-03-06 05:15:37",
              "updated_at": "2022-03-06 05:15:37",
              "metrics": {
                "data": [
                  {
                    "id": 128,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 23,
                    "goal_type": null,
                    "value": "703.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 133,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 23,
                    "goal_type": null,
                    "value": "703.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 202,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 23,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 207,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 23,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 212,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 23,
                    "goal_type": null,
                    "value": "501.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            },
            {
              "id": 24,
              "uuid": "171b7f20-c9f0-48ad-8a09-bc6793cf70b5",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 900,
              "goal_type": "Trainings",
              "meta": "20",
              "points": "10.00",
              "created_at": "2022-03-06 05:15:52",
              "updated_at": "2022-03-06 05:15:52",
              "metrics": {
                "data": [
                  {
                    "id": 132,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 24,
                    "goal_type": null,
                    "value": "1.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 134,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 24,
                    "goal_type": null,
                    "value": "1.00",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 206,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 24,
                    "goal_type": null,
                    "value": "1.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 210,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 24,
                    "goal_type": null,
                    "value": "1.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 213,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 24,
                    "goal_type": null,
                    "value": "1.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            },
            {
              "id": 25,
              "uuid": "da0f3ed6-9c4e-4ad0-9054-67d84e1cc2b6",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 4,
              "goal_type": "Minutes in Zone 2 (Blue)",
              "meta": "200",
              "points": "20.00",
              "created_at": "2022-03-06 05:17:47",
              "updated_at": "2022-03-06 05:17:47",
              "metrics": {
                "data": [
                  {
                    "id": 122,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 25,
                    "goal_type": null,
                    "value": "7.53",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 127,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 25,
                    "goal_type": null,
                    "value": "7.53",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 195,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 25,
                    "goal_type": null,
                    "value": "27.73",
                    "created_at": "2022-03-08 05:20:33",
                    "updated_at": "2022-03-08 05:20:33"
                  },
                  {
                    "id": 198,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 25,
                    "goal_type": null,
                    "value": "27.73",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 205,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 25,
                    "goal_type": null,
                    "value": "27.73",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            },
            {
              "id": 26,
              "uuid": "7a5f9c29-7bbb-4f22-9263-5afcff01f786",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 5,
              "goal_type": "Minutes in Zone 3 (Green)",
              "meta": "300",
              "points": "30.00",
              "created_at": "2022-03-06 05:18:00",
              "updated_at": "2022-03-06 05:18:00",
              "metrics": {
                "data": [
                  {
                    "id": 124,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 26,
                    "goal_type": null,
                    "value": "9.85",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 129,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 26,
                    "goal_type": null,
                    "value": "9.85",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 196,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 26,
                    "goal_type": null,
                    "value": "4.72",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 200,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 26,
                    "goal_type": null,
                    "value": "4.72",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 208,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 26,
                    "goal_type": null,
                    "value": "4.72",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            },
            {
              "id": 27,
              "uuid": "a2e93762-36e8-4530-81db-90a5b7b6bdc0",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 6,
              "goal_type": "Minutes in Zone 4 (Orange)",
              "meta": "200",
              "points": "30.00",
              "created_at": "2022-03-06 05:18:16",
              "updated_at": "2022-03-06 05:18:16",
              "metrics": {
                "data": [
                  {
                    "id": 125,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 27,
                    "goal_type": null,
                    "value": "13.35",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 130,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 27,
                    "goal_type": null,
                    "value": "13.35",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 197,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 27,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 203,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 27,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 209,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 27,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            },
            {
              "id": 28,
              "uuid": "493dc14b-ad98-4a30-817f-5a5c25aff268",
              "branch_uuid": "a71f5493-7e5d-4f68-bdee-f111d72f7894",
              "goal_type_id": 7,
              "goal_type": "Minutes in Zone 5 (Red)",
              "meta": "120",
              "points": "10.00",
              "created_at": "2022-03-06 05:18:51",
              "updated_at": "2022-03-06 05:18:51",
              "metrics": {
                "data": [
                  {
                    "id": 126,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 28,
                    "goal_type": null,
                    "value": "12.20",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 131,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 28,
                    "goal_type": null,
                    "value": "12.20",
                    "created_at": "2022-03-06 06:14:29",
                    "updated_at": "2022-03-06 06:14:29"
                  },
                  {
                    "id": 199,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 28,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 204,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 28,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  },
                  {
                    "id": 211,
                    "challenge_id": 24,
                    "user_id": 84,
                    "goal_id": 28,
                    "goal_type": null,
                    "value": "0.00",
                    "created_at": "2022-03-08 05:20:34",
                    "updated_at": "2022-03-08 05:20:34"
                  }
                ]
              }
            }
          ]
        },
        "total_goals_completed": {
          "data": 0
        }
      }
    ]
  }
}
```

#### fetchUserChallenges

Retrieves a json string with a list of the active challenges of a user.

```swift 
public func fetchUserChallenges(userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.fetchUserChallenges(userUUID: "userUUID") { (httpCode, response) in
    print("user challenges \(response)")
}
```

#### getChallengeHistoryOfUser

Use this method to retrieve the no active challenges of a user

```swift 
public func getChallengeHistoryOfUser(userUUID: String, from startDate: Date? = nil, to endDate: Date? = nil, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.getChallengeHistoryOfUser(userUUID: "ddd-sass-a-w2") { (httpCode, response) in
    print("history challenge \(response)")
}
```

#### getChallengeDetails

Use this method to retrieve challenge's details

```swift 
public func getChallengeDetails(challengeUUID: String, userUUID: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.getChallengeDetails(challengeUUID: "challenge uuid", userUUID: "user uuid") { (httpCode, response) in
    print("challenge details \(response)")
}
```

#### getRankingFromChallenge

Use this method to retrieve a list of the ranking of a challenge

```swift 
public func getRankingFromChallenge(challengeUUID: String, page: Int = 1, completion: @escaping(_ httpCode: Int, _ reponse: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.getRankingFromChallenge(challengeUUID: "challenge uuid", page: 1) { (httpCode, response) in
    print("ranking \(response)")
}
```

#### getUserChallnegeRewardsOfUser

Use this method to retrieve a list of the ranking of a challenge

```swift 
public func getUserChallnegeRewardsOfUser(with uuid: String, completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.getUserChallnegeRewardsOfUser(with: "user uuid") { (httpCode, response) in
    print("user rewards \(response)")
}
```

#### leaveChallenge

This request unsubscribe a user from a challenge.   

```swift 
public func leaveChallenge(challengeUUID: String, userUUID: String,
                                    completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.leaveChellenge(challengeUUID: "uuid", userUUID: "userUUID") { (httpCode, response) in

    print("user unsubscribed")
}
```

#### exitFromChallenge

This method remove a user from a challenge

```swift 
public func exitFromChallenge(challengeUUID: String, userUUID: String,
                                  completion: @escaping(_ httpCode: Int, _ response: String?) -> Void)
``` 

##### Example

```swift 
let apiManager = RMApi()

apiManager.exitFromChallenge(challengeUUID: "uuid", userUUID: "userUUID") { (httpCode, response) in

    print("user unsubscribed")
}
```


### RMStorageManager class

```swift
public class RMStorageManager
```

This class can be used for the developer and for other functions in RM package,  the main purpose of this class is to store information to be consulted later on many situations.

* [User](#user-content-user-storage)
* [Sensor](#user-content-sensor-storage)
* [Training](#user-content-training-storage)
* [Training summaries](#user-content-training-summaries-storage)
* [Training preferences](#user-content-training-preferences)
* [Training update](#user-content-training-update)

### User storage

| Returns      | Function | Description |
| ----------- | ----------- | -------- |
| ```throws```  | ```storeUserInfo(user: RMUser) throws``` | Save a RMUser object in database if not exist and update the info if already exist, Throws an  `NSError`  if the transaction could not be written. |
| `Void` | `deleteUserInfo()` | Deletes the `RMUser` object stored in database. |
| `RMUser?` | `readUserInfo()` | Returns a `RMUser` object, If exists in data base. |
| `String?` | `getUserUUID()`| Returns the user's uuid, if there is a `RMUser` stored in database. |
| `String?` | `getUserToken()`| Returns the user's token, if there is a `RMUser` stored in database. |


#### storeUserInfo()
```swift
public func storeUserInfo(user: RMUser) throws
```
Save a RMUser object in database if not exist and update the info if already exist, Throws an  `NSError`  if the transaction could not be written.

##### Example
```swift
let storageManager = RMStorageManager()

let userToStore = RMUser()
userToStore.userUUID = "3nj3oi2i-1111-2222-3333-fii21"
userToStore.name  = "name"
userToStore.birthday  = "1999-09-09"
userToStore.lastName1 = ""
userToStore.lastName2 = ""
userToStore.sex = "M"
userToStore.email = ""
userToStore.phone = ""

userToStore.physiologicalVariables = RMUserPhysiologicalVariables()
userToStore.physiologicalVariables!.weight = "70"
userToStore.physiologicalVariables!.height = "190"
userToStore.physiologicalVariables!.restingHeartRate = "60"

do {
    try storageManager.storeUserInfo(user: userToStore)
} catch {
    print("Error", error)
}
```

#### deleteUserInfo()
```swift
public func deleteUserInfo()
```

Deletes the `RMUser` object stored in database.

##### Example
```swift
let storageManager = RMStorageManager()
storageManager.deleteUserInfo()
```

#### readUserInfo()
```swift
public func readUserInfo() -> RMUser?
```

Returns a `RMUser` object, If exists in data base.

##### Example
```swift
let storageManager = RMStorageManager()
guard let userInfo = storageManager.readUserInfo() else { return }
print(userInfo.name)
```

#### getUserUUID()
```swift
public func getUserUUID() -> String?
```

Returns the user's uuid, if there is a `RMUser` stored in database.

##### Example
```swift
let storageManager = RMStorageManager()
guard let userUUID = storageManager.getUserUUID() else { return }
print(userUUID)
```

#### getUserToken()
```swift
public func getUserToken() -> String?
```

Returns the user's token, if there is a `RMUser` stored in database.

##### Example
```swift
let storageManager = RMStorageManager()
guard let userToken = storageManager.getUserToken() else { return }
print(userToken)
```

### Sensor storage

| Returns      | Function | Description |
| ----------- | ----------- | -------- |
| `throws` | `storeSensor(sensor: RMSensorAPI)` | Adds or updates a `RMSensorAPI` object in data base. Throws an  `NSError`  if the transaction could not be written. |
| `void` | `deleteAllSensors()` | Removes all the `RMSensorAPI` objects stored in database. |
| `[RMSensorAPI]` | `readSensorsList()` | Retrieves a list of user's sensor stored. |
| `String` | `getSensorUUID(sensorName: String) -> String` | Returns the sensorUUID for the given name. If the sensor does not exist, it will return an empty string. |
| `[RMSensorAPI]` | `getSensorsWithoutUUID() -> [RMSensorAPI]` | Returns a list of stored sensors that do not contain UUIDs. |

#### storeSensor()

```swift
public func storeSensor(sensor: RMSensorAPI) throws
```
Adds or updates a `RMSensorAPI` object in data base. Throws an  `NSError`  if the transaction could not be written.

##### Example

```swift
let storageManager = RMStorageManager()

```

#### deleteAllSensor()

```swift
public func deleteAllSensors()
```
Removes all the `RMSensorAPI` objects stored in database.

##### Example

```swift
let storageManager = RMStorageManager()
storageManager.deleteAllSensor()
```

#### readSensorsList()

```swift
public func readSensorsList()
```
Retrieves a list of user's sensor stored.

##### Example

```swift
let storageManager = RMStorageManager()
let sensorList = storageManager.readSensorList()
print(sensorList)
```

#### getSensorUUID()

```swift
public func getSensorUUID(sensorName: String) -> String
```
Returns the sensorUUID for the given name. If the sensor does not exist, it will return an empty string.

##### Example

```swift
let storageManager = RMStorageManager()
let sensorUUID = storageManager.getSensorUUID(sensorName: "Rook iv2222")
print(sensorUUID)
```

#### getSensorsWithoutUUID()

```swift
public func getSensorsWithoutUUID() -> [RMSensorAPI]
```
Returns a list of stored sensors that do not contain UUIDs.

##### Example

```swift
let storageManager = RMStorageManager()
let sensorList = storageManager.getSensorsWithoutUUID()
print(sensorList)
```
### Training storage

| Returns      | Function | Description |
| ----------- | ----------- | -------- |
| `throws` | `storeTrainingtype(trainingType: RMTrainingType) throws` | Adds a RMTrainingType object in database, if the training exists, it will be updated. |
| `void` | `deleteAllTrainingTypes()` | Deletes All the RMTrainingType objects in the database. |
| `[RMTrainingType]` | `readTrainingTypesList()` | Retrieves the server's TrainingTypes list stored locally.  |
| `[RMTraininigInfo]` | `getPendingTrainings() -> [RMTrainingInfo]` | Retrieves a list of trainings that have not been uploaded to the server. |
| `[RMTrainingInfo]` | `getUnfinishedTraining()` | Retrieves a list of trainings that have not been finished. |

#### storeTrainingtype()
```swift
public func storeTrainingtype(trainingType: RMTrainingType)
```

Adds a RMTrainingType object in database, if the training exists, it will be updated.

##### Example
```swift

// Save training info
let storageManager = RMStorageManager()
let training = RMTrainingType()

do {
    try storageManager.storeTrainingType(trainingType: training)
} catch {
    print("Error while storing", error)
}

```

#### deleteAllTrainingTypes

```swift
public func deleteAllTrainingTypes()
```

Deletes All the RMTrainingType objects in the database.

##### Example

```swift
let storageManager = RMStorageManager()

storageManger.deleteAllTrainingTypes()

```

#### readTrainingTypesList

```swift
public func readTrainingTypesList() -> [RMTrainingType]
```

##### Example

```swift
let storageManager = RMStorageManager()

let trainingTypes = storageManager.readTrainingTypesList()
print(trainingTypes)

```

#### getPendingTrainings()

```swift
public  func  getPendingTrainings() -> [RMTrainingInfo]
```

Retrieves a list of trainings that have not been uploaded to the server.

##### Example

```swift
let storageManager = RMStoageManager()

let pendingTrainings = storageManager.getPendingTrainings()
print(pendingTrainings)

```

#### getUnfinishedTrainings()

```swift
public func getUnfinishedTrainings() -> [RMTrainingInfo]
```

Retrieves a list of trainings that have not been finished.

##### Example

```swift
let storageManager = RMStoageManager()

let unfinishedTrainings =storageManager.getUnfinishedTrainings()
print(unfinishedTrainings)

```

### Training summaries storage

| Returns      | Function | Description |
| ----------- | ----------- | -------- |
| `void` | `saveStepRecord(object: RMStepDataRecords)` | Adds a RMStepDataRecords object on database. |
| `[RMStepDerivedRecord]` | `getAllStepsRecords() -> [RMStepDerivedRecord]` | Returns an array of RMStepDerivedRecord objects stored on database. |
| `void` | `deleteAllStepsRecords()` | Deletes all the RMStepDataRecords stored on database. |
| `void` | `deleteSpecificStepRecord(object : Results<RMStepDataRecords>)` | Deletes the RMStepDataRecords object from database. |
| `void` | `saveHeartRateRecord(object : RMHeartRateDataRecords)` | Adds a RMHeartRateDataRecords object on database. |
|`RMHrDerivedRecord`| `getAllHeartRateRecords() -> [RMHrDerivedRecord]`| Returns an array of RMHrDerivedRecord objects stored on database. |
| `void` | `deleteAllHeartRateRecords` | Deletes all the RMHeartRateDataRecords stored on database. |
| `void` | `deleteSpecificHeartRateRecord(object : Results<RMHeartRateDataRecords>)` | Deletes the RMHeartRateDataRecords object from database. |
| `void` | `saveTrainingInfoRecord(object : RMTrainingInfo)` | Adds a RMTrainingInfo object on database. |
| `[RMTrainingInfo]` | `getAllTrainingInfoRecords() -> [RMTrainingInfo]` | Returns an array of RMTrainingInfo objects stored on database. |
| `void` | `deleteAllTrainingInfoRecords()` | Deletes all the RMTrainingInfo stored on database. |
| `void` | `deleteSpecificTrainingRecord(object : RMTrainingInfo)` | Deletes the RMTrainingInfo object from database. |

### Steps records

#### saveStepRecord()

```swift
public func saveStepRecord(object: RMStepDataRecords)
```

Adds a RMStepDataRecords object on database.

#### getAllStepsRecords()

```swift
public func getAllStepsRecords() -> [RMStepDerivedRecord]
```

Returns an array of RMStepDerivedRecord objects stored on database.

#### deleteAllStepsRecords()

```swift
public func deleteAllStepsRecords()
```

Deletes all the RMStepDataRecords stored on database.

#### deleteSpecificStepRecord()

```swift
public func deleteSpecificStepRecord(object : Results<RMStepDataRecords>)
```

Deletes the RMStepDataRecords object from database.

### Heart rate records

#### saveHeartRateRecord()

```swift
public func saveHeartRateRecord(object : RMHeartRateDataRecords)
```

Adds a RMHeartRateDataRecords object on database.

#### getAllHeartRateRecords()

```swift
public func getAllHeartRateRecords() -> [RMHrDerivedRecord]
```

Returns an array of RMHrDerivedRecord objects stored on database.

#### deleteAllHeartRateRecords()

```swift
public func deleteAllHeartRateRecords()
```

Deletes all the RMHeartRateDataRecords stored on database.

#### deleteSpecificHeartRateRecord()

```swift
public func deleteSpecificHeartRateRecord(object : Results<RMHeartRateDataRecords>)
```

Deletes the RMHeartRateDataRecords object from database.

### Training info records

#### saveTrainingInfoRecord()

```swift
public func saveTrainingInfoRecord(object : RMTrainingInfo)
```

Adds a RMTrainingInfo object on database.

#### getAllTrainingInfoRecords()

```swift
public func getAllTrainingInfoRecords() -> [RMTrainingInfo]
```

Returns an array of RMTrainingInfo objects stored on database.

#### deleteAllTrainingInfoRecords()

```swift
public func deleteAllTrainingInfoRecords()
```

Deletes all the RMTrainingInfo stored on database.

#### deleteSpecificTrainingInfoReference()

```swift
public func deleteSpecificTrainingInfoReference(object : ThreadSafeReference<RMTrainingInfo>)
```

Deletes the RMTrainingInfo object from database.

### Training Preferences

The following methods were created to store an object containing a preferred training type and a preferred sensor for quick access.

| Returns      | Function | Description |
| ----------- | ----------- | --------- |
| `void` | `storeTrainingPreferences(_ preference: RMTrainingPreferences)` | Saves a RMTrainingPreferences object on database, if the object exists, it will be updated |
| `RMTrainingPreferences` | `readTrainingPreferences() -> RMTrainingPreferences?` | Returns the RMTrainingPreferences object stored. |
| `RMTrainingType?` | `getLastUsedTrainingType()` | Returns the training type stored in RMTrainingPreferences |
| `RMSensorAPI?` | `getLastUsedSensor()` | Returns the sensor stored in RMTrainingPreferences |

#### storeTrainingPreferences()

```swift
public func storeTrainingPreferences(_ preference: RMTrainingPreferences)
```

Saves a RMTrainingPreferences object on database, if the object exists, it will be updated.

##### Example
```swift
let storageManager = RMStorageManager()
let trainingType = RMTrainingType()
let sensor = RMSensorAPI()
let trainingPreferences = RMTrainingPreferences()
trainingPreferences.trainingType = trainingType
trainingPreferences.sensor = sensor

storageManager.storeTrainingPreferences(trainingPreferences)

```

#### readTrainingPreferences()

```swift
public func readTrainingPreferences() -> RMTrainingPreferences?
```

Returns the RMTrainingPreferences object stored.

##### Example

```swift
let storageManager = RMStorageManager()

let trainintPreferences = storageManager.readTrainingPreferences()

```

#### getLastUsedTrainingType()

```swift
public func getLastUsedTrainingType() -> RMTrainingType?
```

Returns the training type stored in RMTrainingPreferences.

#### getLastUsedSensor()

```swift
public func getLastUsedSensor() -> RMSensorAPI?
```

Returns the sensor stored in RMTrainingPreferences

### Training update

| Returns      | Function | Description |
| ----------- | ----------- | --------- |
| `void` | `generateSummaries(summary: RMTrainingSummaries, _ heartRateRecordsData: RMHeartRateDataRecords? , _ stepsRecordsData: RMStepDataRecords?, time : Int)` | Updates the heart rate data and the steps data for the training summaries given. |
| `void` | `storeHrSummaries(summary : RMTrainingSummaries, record: RMHeartRateDataRecords, time: Int)` |  This method allows to update the summary records of  a training that corresponds to heart rate, if the heart rate values change, it can be updated. |
| `void` | `storeStepsSummaries(summary : RMTrainingSummaries, record: RMStepDataRecords, time: Int)` | This method allows to update the summary records of  a training that corresponds to steps.|
| `void` | `storeZonesSummaries(summary : RMTrainingSummaries, deltaTime: Float, _ delta_calories: Float, effort: Int, time: Int)` | This method updates the time and the calories burned in each zone. |
| `void` | `storeStepsZonesSummaries(summary : RMTrainingSummaries , delta_steps: Int , cadence: Float, cadenceElements: Int, effort: Int, time: Int)` | This method updates the steps taken in each zone. |
| `void` | `storeTrainingDuration(time: Int, summary : RMTrainingSummaries)`| Stores or updates the duration for a given summary of a training. |
| `void` | `addRecordForTraining(hrRecord: RMHeartRateDataRecords? = nil, stepRecord: RMStepDataRecords? = nil, _ training: RMTrainingInfo)` | Adds a RMHeartRateDataRecords and a RMStepDataRecords object in the given training |
| `void` | `addBicycleRecord(for training: RMTrainingInfo, bicycleRecord: RMBicycleDataRecords)`| Adds a RMBicycleDataRecords object in the given training |
| `void` | `updateTrainingInfo( _ stop: String  = "", sensorUUID: String? = nil, trainingTypeUUID: String? = nil, _ training: RMTrainingInfo)` | Updates a TrainingInfo object whit the sensorUUID, trainingTypeUUID or the stop date given. |
| `void` | `updateTrainingSummariesToSend(summaryElement : RMTrainingSummary, _ training: RMTrainingInfo)` | Updates the RMTrainingSummary object in the training given. |
| `void` | `updateTrainingAuxSummaries(_ training : RMTrainingInfo, auxSummary: RMTrainingAuxiliarSummary)` |Updates the auxiliary summaries of a training.|
|`void` | `updateTrainingSensorProperties(name: String?, sensorUUID: String?, training : RMTrainingInfo)` | Updates the properties of the sensor assigned to a training. |
| `void` | `updateTrainingUploadDate(for training : RMTrainingInfo)` | Updates the property uploadedAt of the RMTrainingInfo object given, the format of the string date is "yyyy-MM-dd HH:mm:ss". |

#### generateSummaries()

```swift
public  func  generateSummaries(summary: RMTrainingSummaries, _ heartRateRecordsData: RMHeartRateDataRecords? , _ stepsRecordsData: RMStepDataRecords?, time : Int)
```
Updates the heart rate data and the steps data for the training summaries given.

**Parameters**:
- summary: RMTrainingSummaries object that will be updated.
- heartRateRecordsData: RMHeartRateDataRecords object to store.
- stepsRecordsData: RMStepDataRecords object to store.

#### storeHrSummaries()

```swift
public func storeHrSummaries(summary : RMTrainingSummaries, record: RMHeartRateDataRecords, time: Int)
```

This method allows to update the summary records of  a training that corresponds to heart rate, if the heart rate values change, it can be updated.

**Parameters**:
-  summary: RMTrainingSummaries object
  - record:  RMHeartRateDataRecords


#### storeStepsSummaries()

```swift
public func storeStepsSummaries(summary : RMTrainingSummaries, record: RMStepDataRecords, time: Int)
```

This method allows to update the summary records of  a training that corresponds to steps.

**Parameters**:
- summary: RMTrainingSummaries object
- record: record the values of given RMStepsDerivedDataRecord

#### storeZonesSummaries

```swift
public func  storeZonesSummaries(summary : RMTrainingSummaries, deltaTime: Float, _ delta_calories: Float, effort: Int, time: Int)
```

This method updates the time and the calories burned in each zone.

**Parameters**:
- summary: RMTrainingSummaries object
- record: an array of Int that contains the five zones times


#### storeStepsZonesSummaries()

```swift
public func storeStepsZonesSummaries(summary : RMTrainingSummaries , delta_steps: Int , cadence: Float, cadenceElements: Int, effort: Int, time: Int)
```

This method updates the steps taken in each zone.

**Parameters**:
- summary: RMTrainingSummaries object
- record: an array of Int that contains the five zones times

#### storeTrainingDuration

```swift
public func storeTrainingDuration(time: Int, summary : RMTrainingSummaries)
```

Stores the training duration for a given summary, it can be updated

**Parameters**:
- time: the time to store
- summary: the summary where to update the time


#### addRecordForTraining

```swift
public func addRecordForTraining(hrRecord: RMHeartRateDataRecords? = nil, stepRecord: RMStepDataRecords? = nil, _ training: RMTrainingInfo)
```

Adds a RMHeartRateDataRecords and a RMStepDataRecords object in the given training

**Parameters**:
- hrRecord: The RMHeartRateDataRecords object to store
- stepRecord: The RMStepDataRecords object to store
- training: The RMTrainingInfo object that will be updated

#### addBicycleRecord

```swift
public func addBicycleRecord(for training: RMTrainingInfo, bicycleRecord: RMBicycleDataRecords)
```

Adds a RMBicycleDataRecords object in the given training

**Parameters**
- bicycleRecord: The RMBicycleDataRecords object to store
- training: The RMTrainingInfo object that will be updated

#### updateTrainingInfo()

```swift
public func updateTrainingInfo( _ stop: String = "", sensorUUID: String? = nil, trainingTypeUUID: String? = nil, _ training: RMTrainingInfo)
```

Updates a TrainingInfo object whit the sensorUUID, trainingTypeUUID or the stop date given.

**Parameters**:

- stop: The string date when the training has finished with the following format yyyy-MM-dd HH:mm:ss
- sensorUUID: The string of the sensor UUID to change
- trainingTypeUUID: The string of the training type UUID to change
- training: The RMTrainingInfo object that will be updated


#### updateTrainingSummariesToSend()

```swift
public func updateTrainingSummariesToSend(summaryElement : RMTrainingSummary, _ training: RMTrainingInfo)
```
Updates the RMTrainingSummary object in the training given

**Parameters**:
- summaryElement: The RMTrainingSummary object that will be appended to the summary.
- training: The RMTrainingInfo object that will be updated

#### updateTrainingAuxSummaries()

```swift
public func updateTrainingAuxSummaries(_ training : RMTrainingInfo, auxSummary: RMTrainingAuxiliarSummary)
```

Updates the auxiliary summaries of a training.

**Parameters**:
- training: The RMTrainingInfo object that will be updated
- auxSummary: The RMTrainingAuxiliarSummary object that will be updated.

#### updateTrainingSensorProperties()

```swift
public func updateTrainingSensorProperties(name: String?, sensorUUID: String?, training : RMTrainingInfo)
```

Updates the properties of the sensor assigned to a training

**Parameters**:
- training: The RMTrainingInfo object that will be updated
- name: The string name of the sensor
- sensorUUID: The string UUID of the sensor

#### updateTrainingUploadDate()

```swift
public func updateTrainingUploadDate(for training : RMTrainingInfo)
```

Updates the property uploadedAt of the RMTrainingInfo object given, the format of the string date is "yyyy-MM-dd HH:mm:ss"

**Parameters**:
- training: The RMTrainingInfo object that will be updated


### RMClass

This class contains RMApi and RMStorageManager methods to facilitate development.


| Returns      | Function | Description |
| ----------- | ----------- | --------- |
| `void` | `addUser(email: String, completion: @escaping (RMResponse) -> Void)` | Creates a new user on the RookMotion server for the email provided, also save the user information  at storage, the elements to save are the email and if the request goes well, the uuid will be saved. |
| `void` | `getUserSensors(completion: @escaping (RMResponse,[RMSensorAPI]?) -> Void)` | Ask for user sensors on the RookMotion server with the stored user UUID , also save the retrieved list on storage automatically. |
| `void` | `getTrainingTypes(completion: @escaping (RMResponse,[RMTrainingType]?) -> Void )` | Ask for training types list  on the RookMotion server or return the training types list available for the client account stored locally. |
| `void` | `addSensor(sensor: RMSensorAPI, completion: @escaping (RMResponse) -> Void)` | Add the selected sensor to the user on WS and stores the sensor on locale database. |
| `void` | `getSensorUUID(sensorName: String, completion: @escaping (String) -> Void)` | Returns at the completion the sensor UUID of a given sensor name. |
| `void` | `updateUserProfile(user: RMUser, completion: @escaping (RMResponse) -> Void)` | Updates the user object variables and properties on WS and database. |
| `void` | `configureUserMetrics(completion: @escaping(RMResponse) -> Void)` | Configures the information used to calculate the metrics of a workout. Before use this method it is necessary to store a RMUser with a userUUID and update its physiological variables, it is recommended to use this method before a training session. |
| `void` | `uploadPendingSensors(completion: @escaping (RMResponse) -> Void)` | Uploads the sensors that still are not on WS. |
| `void` | `uploadPendingTrainings(delete: Bool,completion: @escaping (RMResponse) -> Void)` | Upload workouts that are finished but for some reason it was not possible to upload the workout to WS. |
| `void` | `sendTrainingToWS(_ trainingToSend:RMTrainingInfo, _ usrUUID: String, _ delete: Bool , completion: @escaping (RMResponse) -> Void)` | Uploads a workout to WS but not deletes the training from database just updates the uploadedAt property if the delete property is false |
| `completion block` | `restoreUser(_ email: String, completion: @escaping(RMResponse) -> Void)` | Restore the user information with the email given |

#### RM addUser()

```swift
public func addUser(email: String, completion: @escaping (RMResponse) -> Void)
```
Creates a new user on the RookMotion server for the email provided, also save the user information  at storage, the elements to save are the email and if the request goes well, the uuid will be saved.

**Parameters**:
- email: the user email
- completion: provides a response at completion that tells what happened with your request.

#### getUserSensors()

```swift
public func getUserSensors(completion: @escaping (RMResponse,[RMSensorAPI]?) -> Void)
```

Ask for user sensors on the RookMotion server with the stored user UUID , also save the retrieved list on storage automatically

**Parameter**  
- completion: provides a response at completion that tells what happened with your request, a bool that tells if the process goes well and an array of RMSensorAPI that contains the user sensors info.

#### getTrainingTypes()

```swift
public func getTrainingTypes(completion: @escaping (RMResponse,[RMTrainingType]?) -> Void )
```

Ask for training types list  on the RookMotion server or return the training types list available for the client account stored locally.

**Parameter**  
- completion: provides a RMResponse at completion that tells what happened with your request and an array of RMTrainingType that contains the Training types list.

#### addSensor()

```swift
public func addSensor(sensor: RMSensorAPI, completion: @escaping (RMResponse) -> Void)
```

Add the selected sensor to the user on WS and stores the sensor on locale database.

**Parameters**:
- sensor: RMSensorAPI
- completion: RMResponse

#### getSensorUUID()

```swift
public func getSensorUUID(sensorName: String, completion: @escaping (String) -> Void)
```

Returns at the completion the sensor UUID of a given sensor.
**Parameters**:
- sensorName: the sensor that you want to know the name
- completion: returns a String that contains the UUID if exists

#### updateUserProfile()

```swift
public func updateUserProfile(user: RMUser, completion: @escaping (RMResponse) -> Void)
```
Updates the user object variables and properties on WS
**Parameters**:
- user: User with the info that you want to update
- completion: WS response

#### configureUserMetrics()

```swift
public func configureUserMetrics(completion: @escaping(RMResponse) -> Void)
```

Configures the information used to calculate the metrics of a workout. Before use this method it is necessary to store a RMUser with a userUUID and update its physiological variables, it is recommended to use this method before a training session.

**Parameters**:
- completion: RMResponse


#### uploadPendingSensors()

```swift
public func uploadPendingSensors(completion: @escaping (RMResponse) -> Void)
```

Uploads the sensors that still are not on WS.

**Parameter**  
- completion: WS response

#### uploadPendingTrainings()

```swift
public func uploadPendingTrainings(delete: Bool,completion: @escaping (RMResponse) -> Void)
```

Upload workouts that are finished but for some reason it was not possible to upload the workout to WS.

**Parameters**
- delete: if you want to delete the training after upload this has to be true
- completion: WS response

## RestoreUser

Restore the user information with the email given

**In case you have updated the sdk to a version without the realm dependecy, It is recommened to create a function that restores the user**

```swift
public func restoreUser(_ email: String, completion: @escaping(RMResponse) -> Void)
```

**Parameters**
- email: email `String` of the user to restore.
- completion: RMResponse object 

##### Example 

```swift

let rookMasterClass: RMClass = RMClass()
let rookStorage: RMStorageManager = RMStorageManager()

func restoreUser(email: String) {
  if rookStorage.readUserInfo() == nil {
    rookMasterClass.restoreUser(email) { response in
      print(response)
    }
  }
}


```

#### RMResponse

```swift
public struct RMResponse
```

The RMResponse is a struct that is used as response in some of the above methods, it contains the next properties:

| Type | Name | Description |
| ------ | ------ | -------- |
| `String` | `code` | String that indicates the http code response |
| `String`| `message` | String that contains a message response |
| `Bool` | `success` | Boolean that indicates if the request was a success. |

### RMCommunicationManager

```swift
public  class  RMCommunicationManager: NSObject
```

The `RMCommunicationManager` class contains all the implementations to communicate your application with an apple watch app.

| Returns      | Function | Description |
| ----------- | ----------- | --------- |
| `void` | `configureSession()` | Configure the session communication with the ape watch. |
| `void` | `syncUserInfo()` | Sends all the user information needed to the apple watch paired. |

#### configureSession()

```swift
public  func configureSession()
```

The method starts a communication and manages all the message recived from the apple watch paired.

**It is recommended to call the method ones your app is launch in the app delegate**

##### example

```swift 
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {

let urlBase =  "" // Your url api
let clientKey = "" // Your client key
let token = "" // Your token

RMSettings.shared.setUrlApi(with: urlBase)
RMSettings.shared.setCredentials(client_key: clientKey, token: token)
RMSettings.shared.initRookMotionSDK()
RMCommunicationManager.shared.configureSession()
return  true
}
```


### Delegate

You must assign an object conforming to the RWCommunicationDelegate protocol to this. The delegate is responsible for responding to session-related changes, for processing incoming data, and for responding to errors.

#### CommunicationDelegate

A set of methods that provide the data related to the connection information

```swift
public protocol CommunicationDelegate
```

|Function| Description|
|-------|------------|
|```func session(_ session: WCSession, messageData: [String : **Any**])```|Tells the delegate when a message has been received. |
|```session(_ session: WCSession, userInfo: [String : Any])``` |Tells the delegate when a dictionary has been received.|
|```session(_ session: WCSession, message: [String : Any])```| Tells the delegate when a message has been received. |



### RMModels

#### RMUser

```swift
public class RMUser: Object, Codable
```
The RMUser class is a realm model that conform the  Codable protocol, this model is used to store the information of a user

| Type | Name | Description |
| ------ | ------ | -------- |
| `Int` | id | primaryKey of the object it can not be changed. |
| `String?` | userUUID | The UUID of the user. |
| `String?` | token_user | This property is used to identify if the user is logger with rookmotion, if you use you own authentication method you can store your token in this property. |
| `String?` | name | Name of the user, it has to contain at least 4 characters. |
| `String?` | lastName1 | First last name of the user, it has to contain at least 4 characters. |
| `String?` | lastName2 | Second last name of the user, it has to contain at least 4 characters. |
| `String?` | email | email of the user. |
| `String?` | phone | Phone number of the user it has to contain 8 to 12 numbers |
| `String?` | birthday | Birthday of the user with the format "YYYY-MM-dd" |
| `String?` | sex | Gender of the user ("female" or "male") |
| `String?` | pseudonym | nickname of the user |
| RMUserPhysiologicalVariables? | physiologicalVariables | RMUserPhysiologicalVariables object that contains the physiological variables of the user. |

#### updatePhysiologicalVariables()

```swift
public func updatePhysiologicalVariables(weight: Double, height: Double, restingHeartRate: Int)
```

Update the stored user physiologicalVariables.

**Parameters**:
- weight: value from 30 to 200
- height: value from 120 to 220
- restingHeartRate: value from 40 to 100

#### updateUserProperties()

```swift
public func updateUserProperties(name: String?,lastName1: String?, lastName2 : String?, phone: String?,birthday: String?, sex: String?)
```

Updates the user general information.

**Parameters**:
- name: The user name
- lastName1: the user last name
- lastName2: if the user has other name can be typed here
- phone: phone numer 8 to 12 digits
- birthday: format YYYY-MM-DD
- sex: "male" or "female"

#### RMUserPhysiologicalVariables

```swift
public class RMUserPhysiologicalVariables: Object, Codable
```

The RMUserPhysiologicalVariables class is a realm model that conform the  Codable protocol, this model is used to store the physiological variables of a user.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String` | `weight` | Weight of the user its value has to be from 30 to 200 |
| `String` | `height` | Height of the user its value has to be from 120 to 220 |
| `String` | `restingHeartRate` | Resting heart rate of the user its value from 40 to 100 |

#### RMTrainingType

```swift
public class RMTrainingType: Object, Codable
```

The RMTrainingType class is a realm model that conform the  Codable protocol, this model is used to store the training retrieved from the server.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String?` | `trainingTypeUUID` | The UUID of the training |
| `String?` | `trainigName` | The name of the training |
| `OptionalInt?` | `useHeartRate` | An object that indicates if the workout use heart rate |
| `OptionalInt?` | `useCycling` | An object that indicates if the workout use cycling |
| `OptionalInt?` | `useGps` | An object that indicates if the workout use gps |
| `OptionalInt?` | `useSteps` | An object that indicates if the workout use heart rate |

#### UseSteps

```swift
public class UseSteps: Object, Codable
```

The UseSteps model is used to store if a training use steps.

| Type | Name | Description |
| ------ | ------ | -------- |
| OptionalInt? | `enabled` | Optional Int that indicates if steps are enable |
| `String` | `stepsTypes` | Strings that indicates the type of steps. |

#### RMSensorAPI

```swift
public class RMSensorAPI: Object, Codable
```

This is model is used to store the sensors retrieved from the web service.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String?` |  `sensorName` | The name of the sensor |
| `String?` | `sensorUUID` | The UUID that identifies the sensor on the server |
| `String?` | `sensorMAC` | The mac of the sensor. |
| `String?` | `updatedAt` | Sensor update date with format YYYY-MM-dd. |
| `String?` | `ownershipType` | Indicates the ownership type. |

#### RMTrainingInfo

```swift
public class RMTrainingInfo: Object, Codable
```

RMTrainingInfo model is used to store the workout data, it can help to recover the information, if the app terminates.

| Type | Name | Description |
| ------ | ------ | -------- |
|`String?` | `start` | start date of the workout with the format "yyyy-MM-dd HH:mm:ss" |
|`String?` | `end` | end date of the workout with the format "yyyy-MM-dd HH:mm:ss"  |
|`String?` | `trainingTypeUUID` | The UUID of the training training type that will be performed. |
|`String?` | `sensorUUID` | The UUID of the sensor that is used in the workout. |
|`String?` | `sensorName` | The sensor name that is used in the workout. |
|`String?` | `deviceType` | The device where the workout was performed. |
|`String?` | `uploadedAt` | The uploaded date of the workout. |
|`Int` | `groupalMode` | Indicates if the training was performed in group. |
|`RMAuxiliarSummary??` | `auxSummary` | Object to store the auxiliary summaries of the workout.  |
|`RMTrainingSummaries?` | `summary` | Object to store the summary of the workout. |
|`RMTrainingStoragedRecords?` | `records` | Object to store the list of heart rate records and steps records |
| `RMRemoteClass?` | `remoteClass` | Object to store the properties of a remote training |
|`List<RMTrainingSummary>` | `summaries` | Object to store the summary id and its value |

#### RMAuxiliarSummary

```swift
public class RMAuxiliarSummary: Object
```
RMAuxiliarSummary model helps to store the number of samples ant its value accumulated

| Type | Name | Description |
| ------ | ------ | -------- |
| `Int` | `hrElements` | Number of heart rate samples. |
| `Int` | `hrAccumulated` | Value accumulated of heart rate samples. |
| `Int` | `effortElements` | Number of effort samples. |
| `Int` | `effortAccumulated` | Value accumulated of effort samples. |
| `Int` | `cadenceElements` | Number of cadence samples. |
| `Int` | `cadenceAccumulated` | Value accumulated of cadence samples. |

#### RMTrainingSummaries

```swift
public class RMTrainingSummaries: Object
```
This model contains the training summaries on realtime.

| Type | Name | Description |
| ------ | ------ | -------- |
| `Int` | `duration_time_tot` | Duration of the workout. |
| `Float` | `z1_time` | Time in the first zone. |
| `Float` | `z2_time` | Time in the second zone. |
| `Float` | `z3_time` | Time in the third zone. |
| `Float` | `z4_time` | Time in the fourth zone. |
| `Float` | `z5_time` | Time in the fifth zone. |
| `Int` | `hr_max` | Heart rate max value. |
| `Int` | `hr_min` | Heart rate min value. |
| `Int` | `hr_avg` | Heart rate average value. |
| `Int` | `effort_max` | effort max value. |
| `Int` | `effort_min` | effort min value. |
| `Int` | `effort_avg` | effort average value. |
| `Int` | `calories` | Total calories burned in training. |
| `Float` | `z1_calories_tot` | Total calories burned in the first zone. |
| `Float` | `z2_calories_tot` | Total calories burned in the second zone. |
| `Float` | `z3_calories_tot` | Total calories burned in the third zone. |
| `Float` | `z4_calories_tot` | Total calories burned in the fourth zone. |
| `Float` | `z5_calories_tot` | Total calories burned in the fifth zone. |
| `Int` | `steptsTotal` | Total steps taken in training. |
| `Int` | `z1_steps_tot` | Total steps taken in first zone. |
| `Int` | `z2_steps_tot` | Total steps taken in second zone. |
| `Int` | `z3_steps_tot` | Total steps taken in third zone. |
| `Int` | `z4_steps_tot` | Total steps taken in fourth zone. |
| `Int` | `z5_steps_tot` | Total steps taken in fifth zone. |
| `Int` | `cadence_max` | Cadence max value. |
| `Int` | `cadence_min` | Cadence min value. |
| `Int` | `cadence_avg` | Cadence average value. |
| `Int` | `z1_cadence_tot` | Cadence in the first zone. |
| `Int` | `z2_cadence_tot` | Cadence in the second zone. |
| `Int` | `z3_cadence_tot` | Cadence in the third zone. |
| `Int` | `z4_cadence_tot` | Cadence in the fourth zone. |
| `Int` | `z5_cadence_tot` | Cadence in the fifth zone. |

#### RMRemoteClass

```swift
public class RMRemoteClass: Object
```

This model stores the data of a remote class.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String` | `classUUID` | The UUID for the remote class |
| `String` | `roomUUID` | The UUID of the room |
| `String` | `trainingName` | The training name of the class |
| `Int` | `classDelay` | The period that the data will be send |
| `Int` | `useSteps` | Indicator if the training use step |
| `String` | `stepOptions` | Type of steps of the training |

#### RMTrainingStoragedRecords

```swift
public class RMTrainingStoragedRecords: Object, Codable
```

This model stores a list of the heart rate data and a list of the steps data.

| Type | Name | Description |
| ------ | ------ | -------- |
| `List<RMHeartRateDataRecords>` | `hrDerivedRecords` | List of heart rate data records. |
| `List<RMStepDataRecords>` | `stepsDerivedRecords` | List of steps data records. |

#### RMHeartRateDataRecords

```swift
public class RMHeartRateDataRecords: Object, Codable
```

This model contains the steps derived data that can be calculated on the  Equation class.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String` | `timestamp` | Sample date with format "yyyy-MM-dd HH:mm:ss". |
| `Int` | `heartRate` | Heart rate value. |
| `Float` | `calories` | Calories calculated. |
| `Float` | `effort` | Effort calculated. |
| `String` | `start` | Start date of the training with format "yyyy-MM-dd HH:mm:ss".  |
| `Float` | `heart_rate_variability` | Heart rate variability. |

#### RMStepDataRecords

```swift
public class RMStepDataRecords: Object, Codable
```

This model contains the steps derived data that can be calculated on the Equation class

| Type | Name | Description |
| ------ | ------ | -------- |
| `String` | `timestamp` | Sample date with format "yyyy-MM-dd HH:mm:ss". |
| `Int` | `steps` | Number of steps. |
| `Float` | `cadence` | Cadence calculated. |
| `String` | `start` | Start date of the training with format "yyyy-MM-dd HH:mm:ss".  |

#### RMTrainingSummary

```swift
public class RMTrainingSummary: Object, Codable
```

This model helps to store the summary id and its value.

| Type | Name | Description |
| ------ | ------ | -------- |
| `Int` | `summaryTypeID` | ID of the summary. |
| `Int` | `value` | value of the summary. |

#### RMHrDerivedRecord

```swift
public class RMHrDerivedRecord: Codable
```

This model contains the heart rate derived information from a sensor sample.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String?` | `timestamp` | Date and time of the sample. |
| `Int?` | `heartRate` | The heart rate sample bpm. |
| `Float?` | `calories` | The calories burned. |
| `Float?` | `effort` | The current effort. |
| `Int?` | `heartRateVariability` | The variability of heart rate sample.   |

#### RMStepDerivedRecord

``` swift
public class RMStepDerivedRecord: Codable
```
This model contains the steps derived data that can be calculated on the Equation class  cadence ,steps  and the  timestamp of this data.

| Type | Name | Description |
| ------ | ------ | -------- |
| `String?` | `timestamp` | Date and time of the sample. |
| `Float?` | `cadence` | The cadence of the sample |
| `Int?` | `steps` | The steps count. |


## RookMotion

This documentation is provided by **RookMotion** all rights reserved to Rookeries Development SRL de CV.

**contact** : contacto@rookmotion.com  

Startup México SUM Campus Ciudad de México  

+52 55 39406461


